import{j as c,a as wt,b as Se}from"./ui-vendor-CRek-TH2.js";import{g as bt,u as zt,r as V}from"./wallet-adapter-BdusPX8w.js";import{P as ce,b as St,d as vt,M as et,e as tt,A as Et,V as rt,f as Fe,K as ve,g as It,C as At,h as Tt,T as Ee}from"./solana-vendor-Dw0U37Pl.js";import{c as nt,a as Nt}from"./utils-CyLuIvzy.js";import{s as Bt,u as jt}from"./copy-DZkuWqx-.js";import{P as he,a as Pt,b as Ot,R as kt,T as Dt,i as Ut,f as $t,c as Rt}from"./intervalToDuration-BAi1UB4t.js";import{t as R}from"./index-w-U20KRi.js";import"./createLucideIcon-QEjNn_cq.js";const st=e=>({__option:"Some",value:e}),Be=()=>({__option:"None"}),_t=e=>e&&typeof e=="object"&&"__option"in e&&(e.__option==="Some"&&"value"in e||e.__option==="None"),Ie=e=>e.__option==="Some",Ct=e=>e!==null?st(e):Be();class Mt extends Error{name="InvalidBaseStringError";constructor(t,r,n){const s=`Expected a string of base ${r}, got [${t}].`;super(s),this.cause=n}}const Ft=e=>{const t=e.length,r=BigInt(t);return{description:`base${t}`,fixedSize:null,maxSize:null,serialize(n){if(!n.match(new RegExp(`^[${e}]*$`)))throw new Mt(n,t);if(n==="")return new Uint8Array;const s=[...n];let i=s.findIndex(u=>u!==e[0]);i=i===-1?s.length:i;const a=Array(i).fill(0);if(i===s.length)return Uint8Array.from(a);const o=s.slice(i);let l=0n,d=1n;for(let u=o.length-1;u>=0;u-=1)l+=d*BigInt(e.indexOf(o[u])),d*=r;const m=[];for(;l>0n;)m.unshift(Number(l%256n)),l/=256n;return Uint8Array.from(a.concat(m))},deserialize(n,s=0){if(n.length===0)return["",0];const i=n.slice(s);let a=i.findIndex(m=>m!==0);a=a===-1?i.length:a;const o=e[0].repeat(a);if(a===i.length)return[o,n.length];let l=i.slice(a).reduce((m,u)=>m*256n+BigInt(u),0n);const d=[];for(;l>0n;)d.unshift(e[Number(l%r)]),l/=r;return[o+d.join(""),n.length]}}},$=Ft("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),C=e=>{const t=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(t);let n=0;return e.forEach(s=>{r.set(s,n),n+=s.length}),r},Kt=(e,t)=>{if(e.length>=t)return e;const r=new Uint8Array(t).fill(0);return r.set(e),r},Ke=(e,t)=>Kt(e.slice(0,t),t);class ie extends Error{name="DeserializingEmptyBufferError";constructor(t){super(`Serializer [${t}] cannot deserialize empty buffers.`)}}class me extends Error{name="NotEnoughBytesError";constructor(t,r,n){super(`Serializer [${t}] expected ${r} bytes, got ${n}.`)}}class ke extends Error{name="ExpectedFixedSizeSerializerError";constructor(t){t??="Expected a fixed-size serializer, got a variable-size one.",super(t)}}function it(e,t,r){return{description:r??`fixed(${t}, ${e.description})`,fixedSize:t,maxSize:t,serialize:n=>Ke(e.serialize(n),t),deserialize:(n,s=0)=>{if(n=n.slice(s,s+t),n.length<t)throw new me("fixSerializer",t,n.length);e.fixedSize!==null&&(n=Ke(n,e.fixedSize));const[i]=e.deserialize(n,0);return[i,s+t]}}}function Lt(e,t,r){return{description:e.description,fixedSize:e.fixedSize,maxSize:e.maxSize,serialize:n=>e.serialize(t(n)),deserialize:(n,s=0)=>{const[i,a]=e.deserialize(n,s);return r?[r(i,n,s),a]:[i,a]}}}const Ht=e=>e.replace(/\u0000/g,""),at={description:"utf8",fixedSize:null,maxSize:null,serialize(e){return new TextEncoder().encode(e)},deserialize(e,t=0){const r=new TextDecoder().decode(e.slice(t));return[Ht(r),e.length]}};class ye extends Error{name="InvalidPublicKeyError";constructor(t,r){r=r?`. ${r}`:"",super(`The provided public key is invalid: ${t}${r}`),this.invalidPublicKey=t}}const be=32;function le(e,t=!0){const r=typeof e=="string"?e:typeof e=="object"&&"publicKey"in e?e.publicKey:typeof e=="object"&&"toBase58"in e?e.toBase58():Array.isArray(e)?e[0]:$.deserialize(e)[0];return t&&ot(r),r}const xe=e=>{try{return ot(e),!0}catch{return!1}};function ot(e){if(typeof e!="string")throw new ye(e,"Public keys must be strings.");De(e)}const De=e=>{if(e.length<32||e.length>44)throw new ye(e,"Public keys must be between 32 and 44 characters.");let t;try{t=$.serialize(e)}catch{throw new ye(e,"Public keys must be base58 encoded.")}if(t.length!==be)throw new ye(e,`Public keys must be ${be} bytes.`);return t};let je;(function(e){e.Little="le",e.Big="be"})(je||(je={}));class Vt extends RangeError{name="NumberOutOfRangeError";constructor(t,r,n,s){super(`Serializer [${t}] expected number to be between ${r} and ${n}, got ${s}.`)}}function M(e){let t,r=e.name;return e.size>1&&(t=!("endian"in e.options)||e.options.endian===je.Little,r+=t?"(le)":"(be)"),{description:e.options.description??r,fixedSize:e.size,maxSize:e.size,serialize(n){e.range&&ct(e.name,e.range[0],e.range[1],n);const s=new ArrayBuffer(e.size);return e.set(new DataView(s),n,t),new Uint8Array(s)},deserialize(n,s=0){const i=n.slice(s,s+e.size);Gt("i8",i,e.size);const a=qt(i);return[e.get(a,t),s+e.size]}}}const Jt=e=>e.buffer.slice(e.byteOffset,e.byteLength+e.byteOffset),qt=e=>new DataView(Jt(e)),ct=(e,t,r,n)=>{if(n<t||n>r)throw new Vt(e,t,r,n)},Gt=(e,t,r)=>{if(t.length===0)throw new ie(e);if(t.length<r)throw new me(e,r,t.length)},Wt=(e={})=>M({name:"f32",size:4,set:(t,r,n)=>t.setFloat32(0,Number(r),n),get:(t,r)=>t.getFloat32(0,r),options:e}),Xt=(e={})=>M({name:"f64",size:8,set:(t,r,n)=>t.setFloat64(0,Number(r),n),get:(t,r)=>t.getFloat64(0,r),options:e}),Zt=(e={})=>M({name:"i8",size:1,range:[-+"0x7f"-1,+"0x7f"],set:(t,r)=>t.setInt8(0,Number(r)),get:t=>t.getInt8(0),options:e}),Yt=(e={})=>M({name:"i16",size:2,range:[-+"0x7fff"-1,+"0x7fff"],set:(t,r,n)=>t.setInt16(0,Number(r),n),get:(t,r)=>t.getInt16(0,r),options:e}),Qt=(e={})=>M({name:"i32",size:4,range:[-+"0x7fffffff"-1,+"0x7fffffff"],set:(t,r,n)=>t.setInt32(0,Number(r),n),get:(t,r)=>t.getInt32(0,r),options:e}),er=(e={})=>M({name:"i64",size:8,range:[-BigInt("0x7fffffffffffffff")-1n,BigInt("0x7fffffffffffffff")],set:(t,r,n)=>t.setBigInt64(0,BigInt(r),n),get:(t,r)=>t.getBigInt64(0,r),options:e}),tr=(e={})=>M({name:"i128",size:16,range:[-BigInt("0x7fffffffffffffffffffffffffffffff")-1n,BigInt("0x7fffffffffffffffffffffffffffffff")],set:(t,r,n)=>{const s=n?8:0,i=n?0:8,a=0xffffffffffffffffn;t.setBigInt64(s,BigInt(r)>>64n,n),t.setBigUint64(i,BigInt(r)&a,n)},get:(t,r)=>{const n=r?8:0,s=r?0:8,i=t.getBigInt64(n,r),a=t.getBigUint64(s,r);return(i<<64n)+a},options:e}),_=(e={})=>M({name:"u8",size:1,range:[0,+"0xff"],set:(t,r)=>t.setUint8(0,Number(r)),get:t=>t.getUint8(0),options:e}),rr=(e={})=>M({name:"u16",size:2,range:[0,+"0xffff"],set:(t,r,n)=>t.setUint16(0,Number(r),n),get:(t,r)=>t.getUint16(0,r),options:e}),ge=(e={})=>M({name:"u32",size:4,range:[0,+"0xffffffff"],set:(t,r,n)=>t.setUint32(0,Number(r),n),get:(t,r)=>t.getUint32(0,r),options:e}),nr=(e={})=>M({name:"u64",size:8,range:[0,BigInt("0xffffffffffffffff")],set:(t,r,n)=>t.setBigUint64(0,BigInt(r),n),get:(t,r)=>t.getBigUint64(0,r),options:e}),sr=(e={})=>M({name:"u128",size:16,range:[0,BigInt("0xffffffffffffffffffffffffffffffff")],set:(t,r,n)=>{const s=n?8:0,i=n?0:8,a=0xffffffffffffffffn;t.setBigUint64(s,BigInt(r)>>64n,n),t.setBigUint64(i,BigInt(r)&a,n)},get:(t,r)=>{const n=r?8:0,s=r?0:8,i=t.getBigUint64(n,r),a=t.getBigUint64(s,r);return(i<<64n)+a},options:e}),Z=(e={})=>({description:e.description??"shortU16",fixedSize:null,maxSize:3,serialize:t=>{ct("shortU16",0,65535,t);const r=[0];for(let n=0;;n+=1){const s=t>>n*7;if(s===0)break;const i=127&s;r[n]=i,n>0&&(r[n-1]|=128)}return new Uint8Array(r)},deserialize:(t,r=0)=>{let n=0,s=0;for(;++s;){const i=s-1,a=t[r+i],o=127&a;if(n|=o<<i*7,(a&128)===0)break}return[n,r+s]}});class ze extends Error{name="InvalidNumberOfItemsError";constructor(t,r,n){super(`Expected [${t}] to have ${r} items, got ${n}.`)}}class ir extends Error{name="UnrecognizedArrayLikeSerializerSizeError";constructor(t){super(`Unrecognized array-like serializer size: ${JSON.stringify(t)}`)}}class ar extends Error{name="InvalidDataEnumVariantError";constructor(t,r){super(`Invalid data enum variant. Expected one of [${r.join(", ")}], got "${t}".`)}}class or extends Error{name="InvalidScalarEnumVariantError";constructor(t,r,n,s){super(`Invalid scalar enum variant. Expected one of [${r.join(", ")}] or a number between ${n} and ${s}, got "${t}".`)}}class lt extends RangeError{name="EnumDiscriminatorOutOfRangeError";constructor(t,r,n){super(`Enum discriminator out of range. Expected a number between ${r} and ${n}, got ${t}.`)}}function G(e){return e.reduce((t,r)=>t===null||r===null?null:t+r,0)}function Ue(e,t,r){if(typeof e=="number")return[e,r];if(typeof e=="object")return e.deserialize(t,r);throw new ir(e)}function ae(e){return typeof e=="object"?e.description:`${e}`}function de(e,t){if(typeof e!="number")return null;if(e===0)return 0;const r=G(t);return r===null?null:r*e}function $e(e,t){return typeof e=="object"?e.serialize(t):new Uint8Array}function Y(e,t={}){const r=t.size??ge();return{description:t.description??`array(${e.description}; ${ae(r)})`,fixedSize:de(r,[e.fixedSize]),maxSize:de(r,[e.maxSize]),serialize:n=>{if(typeof r=="number"&&n.length!==r)throw new ze("array",r,n.length);return C([$e(r,n.length),...n.map(s=>e.serialize(s))])},deserialize:(n,s=0)=>{const i=[];if(typeof r=="object"&&n.slice(s).length===0)return[i,s];if(r==="remainder"){for(;s<n.length;){const[l,d]=e.deserialize(n,s);i.push(l),s=d}return[i,s]}const[a,o]=Ue(r,n,s);s=o;for(let l=0;l<a;l+=1){const[d,m]=e.deserialize(n,s);i.push(d),s=m}return[i,s]}}}function cr(e={}){const t=e.size??_();if(t.fixedSize===null)throw new ke("Serializer [bool] requires a fixed size.");return{description:e.description??`bool(${t.description})`,fixedSize:t.fixedSize,maxSize:t.fixedSize,serialize:r=>t.serialize(r?1:0),deserialize:(r,n=0)=>{if(r.slice(n).length===0)throw new ie("bool");const[s,i]=t.deserialize(r,n);return[s===1,i]}}}function we(e={}){const t=e.size??"variable",r=e.description??`bytes(${ae(t)})`,n={description:r,fixedSize:null,maxSize:null,serialize:s=>new Uint8Array(s),deserialize:(s,i=0)=>{const a=s.slice(i);return[a,i+a.length]}};return t==="variable"?n:typeof t=="number"?it(n,t,r):{description:r,fixedSize:null,maxSize:null,serialize:s=>{const i=n.serialize(s),a=t.serialize(i.length);return C([a,i])},deserialize:(s,i=0)=>{if(s.slice(i).length===0)throw new ie("bytes");const[a,o]=t.deserialize(s,i),l=Number(a);i=o;const d=s.slice(i,i+l);if(d.length<l)throw new me("bytes",l,d.length);const[m,u]=n.deserialize(d);return i+=u,[m,i]}}}function lr(e){return e.reduce((t,r)=>t===null||r===null?null:Math.max(t,r),0)}function dr(e,t={}){const r=t.size??_(),n=e.map(([o,l])=>`${String(o)}${l?`: ${l.description}`:""}`).join(", "),i=e.every((o,l,d)=>o[1].fixedSize===d[0][1].fixedSize)?e[0][1].fixedSize:null,a=lr(e.map(([,o])=>o.maxSize));return{description:t.description??`dataEnum(${n}; ${r.description})`,fixedSize:e.length===0?r.fixedSize:G([r.fixedSize,i]),maxSize:e.length===0?r.maxSize:G([r.maxSize,a]),serialize:o=>{const l=e.findIndex(([h])=>o.__kind===h);if(l<0)throw new ar(o.__kind,e.map(([h])=>h));const d=r.serialize(l),u=e[l][1].serialize(o);return C([d,u])},deserialize:(o,l=0)=>{if(o.slice(l).length===0)throw new ie("dataEnum");const[d,m]=r.deserialize(o,l);l=m;const u=e[Number(d)]??null;if(!u)throw new lt(d,0,e.length-1);const[h,I]=u[1].deserialize(o,l);return l=I,[{__kind:u[0],...h??{}},l]}}}function ur(e,t,r={}){const n=r.size??ge();return{description:r.description??`map(${e.description}, ${t.description}; ${ae(n)})`,fixedSize:de(n,[e.fixedSize,t.fixedSize]),maxSize:de(n,[e.maxSize,t.maxSize]),serialize:s=>{if(typeof n=="number"&&s.size!==n)throw new ze("map",n,s.size);const i=Array.from(s,([a,o])=>C([e.serialize(a),t.serialize(o)]));return C([$e(n,s.size),...i])},deserialize:(s,i=0)=>{const a=new Map;if(typeof n=="object"&&s.slice(i).length===0)return[a,i];if(n==="remainder"){for(;i<s.length;){const[d,m]=e.deserialize(s,i);i=m;const[u,h]=t.deserialize(s,i);i=h,a.set(d,u)}return[a,i]}const[o,l]=Ue(n,s,i);i=l;for(let d=0;d<o;d+=1){const[m,u]=e.deserialize(s,i);i=u;const[h,I]=t.deserialize(s,i);i=I,a.set(m,h)}return[a,i]}}}function fr(e,t={}){const r=t.prefix??_(),n=t.fixed??!1;let s=`; ${ae(r)}`,i=e.fixedSize===0?r.fixedSize:null;if(n){if(e.fixedSize===null||r.fixedSize===null)throw new ke("Fixed nullables can only be used with fixed-size serializers");s+="; fixed",i=r.fixedSize+e.fixedSize}return{description:t.description??`nullable(${e.description+s})`,fixedSize:i,maxSize:G([r.maxSize,e.maxSize]),serialize:a=>{const o=r.serialize(+(a!==null));if(n){const d=e.fixedSize,m=a!==null?e.serialize(a).slice(0,d):new Uint8Array(d).fill(0);return C([o,m])}const l=a!==null?e.serialize(a):new Uint8Array;return C([o,l])},deserialize:(a,o=0)=>{if(a.slice(o).length===0)return[null,o];const l=o+(r.fixedSize??0)+(e.fixedSize??0),[d,m]=r.deserialize(a,o);if(o=m,d===0)return[null,n?l:o];const[u,h]=e.deserialize(a,o);return o=h,[u,n?l:o]}}}function hr(e,t={}){const r=t.prefix??_(),n=t.fixed??!1;let s=`; ${ae(r)}`,i=e.fixedSize===0?r.fixedSize:null;if(n){if(e.fixedSize===null||r.fixedSize===null)throw new ke("Fixed options can only be used with fixed-size serializers");s+="; fixed",i=r.fixedSize+e.fixedSize}return{description:t.description??`option(${e.description+s})`,fixedSize:i,maxSize:G([r.maxSize,e.maxSize]),serialize:a=>{const o=_t(a)?a:Ct(a),l=r.serialize(Number(Ie(o)));if(n){const m=e.fixedSize,u=Ie(o)?e.serialize(o.value).slice(0,m):new Uint8Array(m).fill(0);return C([l,u])}const d=Ie(o)?e.serialize(o.value):new Uint8Array;return C([l,d])},deserialize:(a,o=0)=>{if(a.slice(o).length===0)return[Be(),o];const l=o+(r.fixedSize??0)+(e.fixedSize??0),[d,m]=r.deserialize(a,o);if(o=m,d===0)return[Be(),n?l:o];const[u,h]=e.deserialize(a,o);return o=h,[st(u),n?l:o]}}}function Pe(e={}){return{description:e.description??"publicKey",fixedSize:32,maxSize:32,serialize:t=>De(le(t)),deserialize:(t,r=0)=>{const n=t.slice(r,r+32);if(n.length===0)throw new ie("publicKey");if(n.length<be)throw new me("publicKey",be,n.length);return[le(n),r+32]}}}function mr(e,t={}){const r=t.size??_(),n=Object.keys(e),s=Object.values(e),i=s.some(u=>typeof u=="number"),a=s.filter(u=>typeof u=="string").join(", "),o=0,l=i?s.length/2-1:s.length-1,d=i?[...n]:[...new Set([...n,...s])];function m(u){const h=typeof u=="number"&&(u<o||u>l),I=typeof u=="string"&&!d.includes(u);if(h||I)throw new or(u,d,o,l)}return{description:t.description??`enum(${a}; ${r.description})`,fixedSize:r.fixedSize,maxSize:r.maxSize,serialize:u=>{if(m(u),typeof u=="number")return r.serialize(u);const h=s.indexOf(u);return h>=0?r.serialize(h):r.serialize(n.indexOf(u))},deserialize:(u,h=0)=>{if(u.slice(h).length===0)throw new ie("enum");const[I,B]=r.deserialize(u,h),T=Number(I);if(h=B,T<o||T>l)throw new lt(T,o,l);return[i?T:s[T],h]}}}function gr(e,t={}){const r=t.size??ge();return{description:t.description??`set(${e.description}; ${ae(r)})`,fixedSize:de(r,[e.fixedSize]),maxSize:de(r,[e.maxSize]),serialize:n=>{if(typeof r=="number"&&n.size!==r)throw new ze("set",r,n.size);const s=Array.from(n,i=>e.serialize(i));return C([$e(r,n.size),...s])},deserialize:(n,s=0)=>{const i=new Set;if(typeof r=="object"&&n.slice(s).length===0)return[i,s];if(r==="remainder"){for(;s<n.length;){const[l,d]=e.deserialize(n,s);i.add(l),s=d}return[i,s]}const[a,o]=Ue(r,n,s);s=o;for(let l=0;l<a;l+=1){const[d,m]=e.deserialize(n,s);i.add(d),s=m}return[i,s]}}}function dt(e={}){const t=e.size??ge(),r=e.encoding??at,n=e.description??`string(${r.description}; ${ae(t)})`;return t==="variable"?{...r,description:n}:typeof t=="number"?it(r,t,n):{description:n,fixedSize:null,maxSize:null,serialize:s=>{const i=r.serialize(s),a=t.serialize(i.length);return C([a,i])},deserialize:(s,i=0)=>{if(s.slice(i).length===0)throw new ie("string");const[a,o]=t.deserialize(s,i),l=Number(a);i=o;const d=s.slice(i,i+l);if(d.length<l)throw new me("string",l,d.length);const[m,u]=r.deserialize(d);return i+=u,[m,i]}}}function oe(e,t={}){const r=e.map(([n,s])=>`${String(n)}: ${s.description}`).join(", ");return{description:t.description??`struct(${r})`,fixedSize:G(e.map(([,n])=>n.fixedSize)),maxSize:G(e.map(([,n])=>n.maxSize)),serialize:n=>{const s=e.map(([i,a])=>a.serialize(n[i]));return C(s)},deserialize:(n,s=0)=>{const i={};return e.forEach(([a,o])=>{const[l,d]=o.deserialize(n,s);s=d,i[a]=l}),[i,s]}}}function pr(e,t={}){const r=e.map(n=>n.description).join(", ");return{description:t.description??`tuple(${r})`,fixedSize:G(e.map(n=>n.fixedSize)),maxSize:G(e.map(n=>n.maxSize)),serialize:n=>{if(n.length!==e.length)throw new ze("tuple",e.length,n.length);return C(e.map((s,i)=>s.serialize(n[i])))},deserialize:(n,s=0)=>{const i=[];return e.forEach(a=>{const[o,l]=a.deserialize(n,s);i.push(o),s=l}),[i,s]}}}function yr(e={}){return{description:e.description??"unit",fixedSize:0,maxSize:0,serialize:()=>new Uint8Array,deserialize:(t,r=0)=>[void 0,r]}}const xr=$;class ut extends Error{name="UmiError";constructor(t,r,n,s){super(t),this.source=r,this.sourceDetails=n,this.cause=s,this.message=`${this.message}

Source: ${this.getFullSource()}${this.cause?`

Caused By: ${this.cause}`:""}
`}getCapitalizedSource(){return this.source==="sdk"||this.source==="rpc"?this.source.toUpperCase():this.source[0].toUpperCase()+this.source.slice(1)}getFullSource(){const t=this.getCapitalizedSource(),r=this.sourceDetails?` > ${this.sourceDetails}`:"";return t+r}toString(){return`[${this.name}] ${this.message}`}}class Re extends ut{name="SdkError";constructor(t,r){super(t,"sdk",void 0,r)}}const wr=128,Oe=e=>(e=typeof e=="object"?e.toString():e,BigInt(e)),ft=(e,t,r)=>({basisPoints:Oe(e),identifier:t,decimals:r}),re=e=>ft(e,"SOL",9),br=e=>e.basisPoints===BigInt(0),zr=["api.mainnet-beta.solana.com","ssc-dao.genesysgo.net"],Sr=["api.devnet.solana.com","psytrbhymqlkfrhudd.dev.genesysgo.net"],vr=["api.testnet.solana.com"],Er=["localhost","127.0.0.1"],Ir=e=>{const t=new URL(e).hostname;return zr.includes(t)?"mainnet-beta":Sr.includes(t)?"devnet":vr.includes(t)?"testnet":Er.includes(t)?"localnet":e.includes("mainnet")?"mainnet-beta":e.includes("devnet")?"devnet":e.includes("testnet")?"testnet":e.includes("local")?"localnet":"custom"};class Q extends Re{name="InterfaceImplementationMissingError";constructor(t,r){const n=t.replace(/Interface$/,""),s=`Tried using ${t} but no implementation of that interface was found. Make sure an implementation is registered, e.g. via "context.${r} = new My${n}();".`;super(s)}}function Ar(){const e=()=>{throw new Q("DownloaderInterface","downloader")};return{download:e,downloadJson:e}}function Tr(){const e=()=>{throw new Q("EddsaInterface","eddsa")};return{generateKeypair:e,createKeypairFromSecretKey:e,createKeypairFromSeed:e,isOnCurve:e,findPda:e,sign:e,verify:e}}function Nr(){return{send:()=>{throw new Q("HttpInterface","http")}}}function Br(){const e=()=>{throw new Q("ProgramRepositoryInterface","programs")};return{has:e,get:e,getPublicKey:e,all:e,add:e,bind:e,unbind:e,clone:e,resolveError:e}}function jr(){const e=()=>{throw new Q("RpcInterface","rpc")};return{getEndpoint:e,getCluster:e,getAccount:e,getAccounts:e,getProgramAccounts:e,getBlockTime:e,getBalance:e,getRent:e,getSlot:e,getGenesisHash:e,getLatestBlockhash:e,getTransaction:e,getSignatureStatuses:e,accountExists:e,airdrop:e,call:e,sendTransaction:e,simulateTransaction:e,confirmTransaction:e}}function Pr(){const e=()=>{throw new Q("SerializerInterface","serializer")};return{tuple:e,array:e,map:e,set:e,option:e,nullable:e,struct:e,enum:e,dataEnum:e,string:e,bool:e,unit:e,u8:e,u16:e,u32:e,u64:e,u128:e,i8:e,i16:e,i32:e,i64:e,i128:e,f32:e,f64:e,bytes:e,publicKey:e}}const Or=(e,t)=>e.reduce((r,n,s)=>{const i=Math.floor(s/t);return r[i]||(r[i]=[]),r[i].push(n),r},[]);function Le(){const e=new Error("Trying to use a NullSigner. Did you forget to set a Signer on your Umi instance? See the `signerIdentity` method for more information."),t=()=>{throw e};return{get publicKey(){throw e},signMessage:t,signTransaction:t,signAllTransactions:t}}function kr(){const e=()=>{throw new Q("TransactionFactoryInterface","transactions")};return{create:e,serialize:e,deserialize:e,serializeMessage:e,deserializeMessage:e}}function Dr(){const e=()=>{throw new Q("UploaderInterface","uploader")};return{upload:e,uploadJson:e,getUploadPrice:e}}const Ur=()=>({downloader:Ar(),eddsa:Tr(),http:Nr(),identity:Le(),payer:Le(),programs:Br(),rpc:jr(),serializer:Pr(),transactions:kr(),uploader:Dr()}),$r=e=>{if(typeof e=="string"||Rr(e)){const t=new Date(e),r=Math.floor(t.getTime()/1e3);return Oe(r)}return Oe(e)},Rr=e=>Object.prototype.toString.call(e)==="[object Date]",_r=(e=20,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")=>{let r="";const n=t.length;for(let s=0;s<e;s+=1)r+=t.charAt(Math.floor(Math.random()*n));return r},Cr=(e,t,r={})=>({buffer:typeof e=="string"?at.serialize(e):e,fileName:t,displayName:r.displayName??t,uniqueName:r.uniqueName??_r(),contentType:r.contentType??null,extension:r.extension??Mr(t),tags:r.tags??[]}),Mr=e=>{const t=e.lastIndexOf(".");return t<0?null:e.slice(t+1)},He=()=>new J({method:"get",data:void 0,headers:{},url:""});class J{constructor(t){this.request=t}asJson(){return this.contentType("application/json")}asMultipart(){return this.contentType("multipart/form-data")}asForm(){return this.contentType("application/x-www-form-urlencoded")}accept(t){return this.withHeader("accept",t)}contentType(t){return this.withHeader("content-type",t)}userAgent(t){return this.withHeader("user-agent",t)}withToken(t,r="Bearer"){return this.withHeader("authorization",`${r} ${t}`)}withHeader(t,r){return this.withHeaders({[t]:r})}withHeaders(t){return new J({...this.request,headers:{...this.request.headers,...t}})}dontFollowRedirects(){return this.followRedirects(0)}followRedirects(t){return new J({...this.request,maxRedirects:t})}withoutTimeout(){return this.withTimeout(0)}withTimeout(t){return new J({...this.request,timeout:t})}withAbortSignal(t){return new J({...this.request,signal:t})}withEndpoint(t,r){return new J({...this.request,method:t,url:r})}withParams(t){const r=new URL(this.request.url),n=new URLSearchParams(t),s=new URLSearchParams(r.searchParams);return[...n.entries()].forEach(([i,a])=>{s.append(i,a)}),r.search=s.toString(),new J({...this.request,url:r.toString()})}withData(t){return new J({...this.request,data:t})}get(t){return this.withEndpoint("get",t)}post(t){return this.withEndpoint("post",t)}put(t){return this.withEndpoint("put",t)}patch(t){return this.withEndpoint("patch",t)}delete(t){return this.withEndpoint("delete",t)}get method(){return this.request.method}get url(){return this.request.url}get data(){return this.request.data}get headers(){return this.request.headers}get maxRedirects(){return this.request.maxRedirects}get timeout(){return this.request.timeout}get signal(){return this.request.signal}}const Fr=()=>({...Ur(),use(e){return e.install(this),this}});class Kr extends ut{name="ProgramError";constructor(t,r,n){super(t,"program",`${r.name} [${r.publicKey}]`,n),this.program=r,this.logs=n?.logs,this.logs&&(this.message+=`
Program Logs:
${this.logs.map(s=>`| ${s}`).join(`
`)}
`)}}function Lr(e){const t=async(s,i={})=>{const a=await e.http.send(He().get(s).withAbortSignal(i.signal));return Cr(a.body,s)};return{download:async(s,i={})=>Promise.all(s.map(a=>t(a,i))),downloadJson:async(s,i={})=>(await e.http.send(He().get(s).withAbortSignal(i.signal))).data}}const Hr=()=>({install(e){e.downloader=Lr(e)}});function q(e){return e.toBase58()}function O(e){return new ce(e)}function Ve(e){return new St({keys:e.keys.map(t=>({...t,pubkey:O(t.pubkey)})),programId:O(e.programId),data:vt.Buffer.from(e.data)})}function Ae(e){return{publicKey:q(e.publicKey),secretKey:e.secretKey}}function ht(e){return{version:e.version,header:e.header,accounts:e.staticAccountKeys.map(q),blockhash:e.recentBlockhash,instructions:e.compiledInstructions.map(t=>({programIndex:t.programIdIndex,accountIndexes:t.accountKeyIndexes,data:new Uint8Array(t.data)})),addressLookupTables:e.addressTableLookups.map(t=>({publicKey:q(t.accountKey),writableIndexes:t.writableIndexes,readonlyIndexes:t.readonlyIndexes}))}}function Vr(e){return e.version==="legacy"?new et({header:e.header,accountKeys:e.accounts.map(O),recentBlockhash:e.blockhash,instructions:e.instructions.map(t=>({programIdIndex:t.programIndex,accounts:t.accountIndexes,data:xr.deserialize(t.data)[0]}))}):new tt({header:e.header,staticAccountKeys:e.accounts.map(O),recentBlockhash:e.blockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIndex,accountKeyIndexes:t.accountIndexes,data:t.data})),addressTableLookups:e.addressLookupTables.map(t=>({accountKey:O(t.publicKey),writableIndexes:t.writableIndexes,readonlyIndexes:t.readonlyIndexes}))})}function Jr(e){return e.version==="legacy"?et.compile({payerKey:O(e.payer),instructions:e.instructions.map(Ve),recentBlockhash:e.blockhash}):tt.compile({payerKey:O(e.payer),instructions:e.instructions.map(Ve),recentBlockhash:e.blockhash,addressLookupTableAccounts:e.addressLookupTables?.map(t=>new Et({key:O(t.publicKey),state:{addresses:t.addresses.map(O),authority:void 0,deactivationSlot:BigInt(`0x${"ff".repeat(8)}`),lastExtendedSlot:0,lastExtendedSlotStartIndex:0}}))})}function qr(e){return new rt(Vr(e.message),e.signatures)}function Gr(){return{generateKeypair:()=>Ae(ve.generate()),createKeypairFromSecretKey:o=>Ae(ve.fromSecretKey(o)),createKeypairFromSeed:o=>Ae(ve.fromSeed(o)),isOnCurve:o=>ce.isOnCurve(O(le(o))),findPda:(o,l)=>{const[d,m]=ce.findProgramAddressSync(l,O(le(o)));return[q(d),m]},sign:(o,l)=>Fe.sign(o,l.secretKey.slice(0,32)),verify:(o,l,d)=>Fe.verify(l,o,De(d))}}const Wr=()=>({install(e){e.eddsa=Gr()}});var Je={},P=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Je<"u"&&Je||{},D={searchParams:"URLSearchParams"in P,iterable:"Symbol"in P&&"iterator"in Symbol,blob:"FileReader"in P&&"Blob"in P&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in P,arrayBuffer:"ArrayBuffer"in P};function Xr(e){return e&&DataView.prototype.isPrototypeOf(e)}if(D.arrayBuffer)var Zr=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Yr=ArrayBuffer.isView||function(e){return e&&Zr.indexOf(Object.prototype.toString.call(e))>-1};function ue(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function _e(e){return typeof e!="string"&&(e=String(e)),e}function Ce(e){var t={next:function(){var r=e.shift();return{done:r===void 0,value:r}}};return D.iterable&&(t[Symbol.iterator]=function(){return t}),t}function N(e){this.map={},e instanceof N?e.forEach(function(t,r){this.append(r,t)},this):Array.isArray(e)?e.forEach(function(t){if(t.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+t.length);this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}N.prototype.append=function(e,t){e=ue(e),t=_e(t);var r=this.map[e];this.map[e]=r?r+", "+t:t};N.prototype.delete=function(e){delete this.map[ue(e)]};N.prototype.get=function(e){return e=ue(e),this.has(e)?this.map[e]:null};N.prototype.has=function(e){return this.map.hasOwnProperty(ue(e))};N.prototype.set=function(e,t){this.map[ue(e)]=_e(t)};N.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)};N.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),Ce(e)};N.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),Ce(e)};N.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),Ce(e)};D.iterable&&(N.prototype[Symbol.iterator]=N.prototype.entries);function Te(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function mt(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function Qr(e){var t=new FileReader,r=mt(t);return t.readAsArrayBuffer(e),r}function en(e){var t=new FileReader,r=mt(t),n=/charset=([A-Za-z0-9_-]+)/.exec(e.type),s=n?n[1]:"utf-8";return t.readAsText(e,s),r}function tn(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}function qe(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function gt(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:D.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:D.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:D.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():D.arrayBuffer&&D.blob&&Xr(e)?(this._bodyArrayBuffer=qe(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):D.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||Yr(e))?this._bodyArrayBuffer=qe(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):D.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},D.blob&&(this.blob=function(){var e=Te(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=Te(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(D.blob)return this.blob().then(Qr);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var e=Te(this);if(e)return e;if(this._bodyBlob)return en(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(tn(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},D.formData&&(this.formData=function(){return this.text().then(sn)}),this.json=function(){return this.text().then(JSON.parse)},this}var rn=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function nn(e){var t=e.toUpperCase();return rn.indexOf(t)>-1?t:e}function se(e,t){if(!(this instanceof se))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t=t||{};var r=t.body;if(e instanceof se){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new N(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!r&&e._bodyInit!=null&&(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",(t.headers||!this.headers)&&(this.headers=new N(t.headers)),this.method=nn(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||(function(){if("AbortController"in P){var i=new AbortController;return i.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),(this.method==="GET"||this.method==="HEAD")&&(t.cache==="no-store"||t.cache==="no-cache")){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+new Date().getTime());else{var s=/\?/;this.url+=(s.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}se.prototype.clone=function(){return new se(this,{body:this._bodyInit})};function sn(e){var t=new FormData;return e.trim().split("&").forEach(function(r){if(r){var n=r.split("="),s=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(s),decodeURIComponent(i))}}),t}function an(e){var t=new N,r=e.replace(/\r?\n[\t ]+/g," ");return r.split("\r").map(function(n){return n.indexOf(`
`)===0?n.substr(1,n.length):n}).forEach(function(n){var s=n.split(":"),i=s.shift().trim();if(i){var a=s.join(":").trim();try{t.append(i,a)}catch(o){console.warn("Response "+o.message)}}}),t}gt.call(se.prototype);function H(e,t){if(!(this instanceof H))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=t.status===void 0?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText===void 0?"":""+t.statusText,this.headers=new N(t.headers),this.url=t.url||"",this._initBody(e)}gt.call(H.prototype);H.prototype.clone=function(){return new H(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new N(this.headers),url:this.url})};H.error=function(){var e=new H(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var on=[301,302,303,307,308];H.redirect=function(e,t){if(on.indexOf(t)===-1)throw new RangeError("Invalid status code");return new H(null,{status:t,headers:{location:e}})};var ne=P.DOMException;try{new ne}catch{ne=function(t,r){this.message=t,this.name=r;var n=Error(t);this.stack=n.stack},ne.prototype=Object.create(Error.prototype),ne.prototype.constructor=ne}function pt(e,t){return new Promise(function(r,n){var s=new se(e,t);if(s.signal&&s.signal.aborted)return n(new ne("Aborted","AbortError"));var i=new XMLHttpRequest;function a(){i.abort()}i.onload=function(){var d={statusText:i.statusText,headers:an(i.getAllResponseHeaders()||"")};s.url.indexOf("file://")===0&&(i.status<200||i.status>599)?d.status=200:d.status=i.status,d.url="responseURL"in i?i.responseURL:d.headers.get("X-Request-URL");var m="response"in i?i.response:i.responseText;setTimeout(function(){r(new H(m,d))},0)},i.onerror=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},i.ontimeout=function(){setTimeout(function(){n(new TypeError("Network request timed out"))},0)},i.onabort=function(){setTimeout(function(){n(new ne("Aborted","AbortError"))},0)};function o(d){try{return d===""&&P.location.href?P.location.href:d}catch{return d}}if(i.open(s.method,o(s.url),!0),s.credentials==="include"?i.withCredentials=!0:s.credentials==="omit"&&(i.withCredentials=!1),"responseType"in i&&(D.blob?i.responseType="blob":D.arrayBuffer&&(i.responseType="arraybuffer")),t&&typeof t.headers=="object"&&!(t.headers instanceof N||P.Headers&&t.headers instanceof P.Headers)){var l=[];Object.getOwnPropertyNames(t.headers).forEach(function(d){l.push(ue(d)),i.setRequestHeader(d,_e(t.headers[d]))}),s.headers.forEach(function(d,m){l.indexOf(m)===-1&&i.setRequestHeader(m,d)})}else s.headers.forEach(function(d,m){i.setRequestHeader(m,d)});s.signal&&(s.signal.addEventListener("abort",a),i.onreadystatechange=function(){i.readyState===4&&s.signal.removeEventListener("abort",a)}),i.send(typeof s._bodyInit>"u"?null:s._bodyInit)})}pt.polyfill=!0;P.fetch||(P.fetch=pt,P.Headers=N,P.Request=se,P.Response=H);var Ne,Ge;function cn(){return Ge||(Ge=1,Ne=self.fetch.bind(self)),Ne}var ln=cn();const dn=It(ln);function un(){return{send:async e=>{const t=e.headers?Object.entries(e.headers).reduce((d,[m,u])=>({...d,[m.toLowerCase()]:(Array.isArray(u)?u.join(", "):u).toLowerCase()}),{}):{},r=t["content-type"]?.includes("application/json")??!1;let n;r&&e.data?n=JSON.stringify(e.data):n=e.data;const s={method:e.method,body:n,headers:t,follow:e.maxRedirects,signal:e.signal,timeout:e.timeout},i=await dn(e.url,s),a=i.headers.get("content-type")?.includes("application/json")??!1,o=await i.text();return{data:(a?JSON.parse(o):void 0)??o,body:o,ok:i.ok,status:i.status,statusText:i.statusText,headers:Object.fromEntries(i.headers.entries())}}}}const fn=()=>({install(e){e.http=un()}});class hn extends Re{name="ProgramNotRecognizedError";constructor(t,r){const n=!xe(t),s=t,i=r==="*"?"any":`the [${r}]`,a=`The provided program ${n?"name":"address"} [${s}] is not recognized in ${i} cluster. Did you forget to register this program? If so, you may use "context.programs.add(myProgram)" to fix this.`;super(a),this.identifier=t,this.cluster=r}}class mn extends Kr{name="ProgramErrorNotRecognizedError";constructor(t,r){const n=r.code?` of code [${r.code}]`:"",s=`The program [${t.name}] at address [${t.publicKey}] raised an error${n} that is not recognized by the programs registered on the SDK. Please check the underlying program error below for more details.`;super(s,t,r)}}function yt(e,t=[],r={}){const n=[...t],s={...r},i=(S,A="current")=>{const j=l(A),U=T(S);return xe(U)?j.some(k=>k.publicKey===U):j.some(k=>k.name===U)},a=(S,A="current")=>{const j=B(A),U=l(A),k=T(S),K=xe(k)?U.find(x=>x.publicKey===k):U.find(x=>x.name===k);if(!K)throw new hn(k,j);return K},o=(S,A,j)=>{try{return a(S,j).publicKey}catch(U){if(A===void 0)throw U;return le(A)}},l=(S="current")=>{const A=B(S);return A==="*"?n:n.filter(j=>j.isOnCluster(A))},d=(S,A=!0)=>{!A&&i(S.publicKey,"*")||n.unshift(S)},m=(S,A)=>{s[S]=A,T(S)},u=S=>{delete s[S]},h=()=>yt(e,n,s),I=(S,A)=>{if(!Array.isArray(S.logs)||S.logs.length===0)return null;const j=S.logs.join(`
`),U=/Error processing Instruction (\d+):/,k=S.message.match(U)?.[1]??null,K=/Custom program error: (0x[a-f0-9]+)/i,x=j.match(K)?.[1]??null,b=x?parseInt(x,16):null;if(k===null||b===null)return null;const p=parseInt(k,10),z=A.message.instructions?.[p]?.programIndex??null,E=z?A.message.accounts[z]:null;if(!E)return null;let L;try{L=a(E)}catch{return null}return L.getErrorFromCode(b,S)??new mn(L,S)},B=S=>S==="current"?e.rpc.getCluster():S,T=(S,A=[])=>{if(xe(S)||s[S]===void 0)return S;const j=[...A,S];if(A.includes(S))throw new Error(`Circular binding detected: ${j.join(" -> ")}`);return T(s[S],j)};return{has:i,get:a,getPublicKey:o,all:l,add:d,bind:m,unbind:u,clone:h,resolveError:I}}const gn=()=>({install(e){e.programs=yt(e)}});function We(e,t,r){let n=null;const s=()=>n||(typeof t=="string"?n=new At(t,r):n=t,n),i=Ir(s().rpcEndpoint),a=async(x,b={})=>{const p=await s().getAccountInfo(O(x),b);return Xe(p,x)},o=async(x,b={})=>(await s().getMultipleAccountsInfo(x.map(O),b)).map((z,E)=>Xe(z,x[E])),l=async(x,b={})=>(await s().getProgramAccounts(O(x),{...b,filters:b.filters?.map(z=>pn(z))})).map(({pubkey:z,account:E})=>xt(E,q(z))),d=async(x,b={})=>{const p=await s().getBlockTime(x);return p?$r(p):null},m=async(x,b={})=>{const p=await s().getBalance(O(x),b);return re(p)},u=async()=>await s().getGenesisHash(),h=async(x,b={})=>{const p=z=>s().getMinimumBalanceForRentExemption(z,b.commitment);if(b.includesHeaderBytes??!1){const z=await p(0),E=BigInt(z)/BigInt(wr);return re(E*BigInt(x))}return re(await p(x))},I=async(x={})=>s().getLatestBlockhash(x),B=async(x,b={})=>{const p=await s().getTransaction($.deserialize(x)[0],{commitment:b.commitment,maxSupportedTransactionVersion:0});if(!p)return null;if(!p.meta)throw new Error("Transaction meta is missing.");const{transaction:z,meta:E}=p,L=ht(z.message),ee=g=>q(new ce(g)),W=g=>({accountIndex:g.accountIndex,amount:ft(g.uiTokenAmount.amount,"splToken",g.uiTokenAmount.decimals),mint:ee(g.mint),owner:g.owner?ee(g.owner):null});return{response:{blockTime:p.blockTime!=null?BigInt(p.blockTime):void 0,slot:BigInt(p.slot),version:p.version},message:L,serializedMessage:e.transactions.serializeMessage(L),signatures:z.signatures.map($.serialize),meta:{fee:re(E.fee),logs:E.logMessages??[],preBalances:E.preBalances.map(re),postBalances:E.postBalances.map(re),preTokenBalances:(E.preTokenBalances??[]).map(W),postTokenBalances:(E.postTokenBalances??[]).map(W),innerInstructions:E.innerInstructions?.map(g=>({index:g.index,instructions:g.instructions.map(f=>({programIndex:f.programIdIndex,accountIndexes:f.accounts,data:$.serialize(f.data)}))}))??null,loadedAddresses:{writable:(E.loadedAddresses?.writable??[]).map(q),readonly:(E.loadedAddresses?.readonly??[]).map(q)},computeUnitsConsumed:E.computeUnitsConsumed?BigInt(E.computeUnitsConsumed):null,costUnits:E.costUnits?BigInt(E.costUnits):null,err:E.err}}},T=async(x,b={})=>(await s().getSignatureStatuses(x.map(z=>$.deserialize(z)[0]),{searchTransactionHistory:b?.searchTransactionHistory??!1})).value.map(z=>z?{slot:z.slot,confirmations:z.confirmations,error:z.err,commitment:z.confirmationStatus??null}:null),S=async(x,b={})=>!br(await m(x,b)),A=async(x,b,p={})=>{const z=await s().requestAirdrop(O(x),Number(b.basisPoints));if(p.strategy){await K($.serialize(z),p);return}await K($.serialize(z),{...p,strategy:{type:"blockhash",...await I()}})},j=async(x,b,p={})=>{const z=s()._rpcClient,E=Array.isArray(b)?xn([...b],p.commitment,p.extra):wn(b,p.commitment,p.extra);return new Promise((L,ee)=>{const W=(g,f)=>{g?ee(g):L(f.result)};p.id?z.request(x,E,p.id,W):z.request(x,E,W)})},U=async(x,b={})=>{try{const p=await s().sendRawTransaction(e.transactions.serialize(x),b);return $.serialize(p)}catch(p){let z=null;throw p instanceof Error&&"logs"in p&&(z=e.programs.resolveError(p,x)),z||p}},k=async(x,b={})=>{try{const p=qr(x);return(await s().simulateTransaction(p,{sigVerify:b.verifySignatures,accounts:{addresses:b.accounts||[],encoding:"base64"},replaceRecentBlockhash:b.replaceRecentBlockhash})).value}catch(p){let z=null;throw p instanceof Error&&"logs"in p&&(z=e.programs.resolveError(p,x)),z||p}},K=async(x,b)=>s().confirmTransaction(yn(x,b),b.commitment);return{getEndpoint:()=>s().rpcEndpoint,getCluster:()=>i,getAccount:a,getAccounts:o,getProgramAccounts:l,getBlockTime:d,getGenesisHash:u,getBalance:m,getRent:h,getSlot:async(x={})=>s().getSlot(x),getLatestBlockhash:I,getTransaction:B,getSignatureStatuses:T,accountExists:S,airdrop:A,call:j,sendTransaction:U,simulateTransaction:k,confirmTransaction:K,get connection(){return s()}}}function xt(e,t){return{executable:e.executable,owner:q(e.owner),lamports:re(e.lamports),rentEpoch:e.rentEpoch?BigInt(e.rentEpoch):void 0,publicKey:t,data:new Uint8Array(e.data)}}function Xe(e,t){return e?{...xt(e,t),exists:!0}:{exists:!1,publicKey:t}}function pn(e){if(!("memcmp"in e))return e;const{bytes:t,...r}=e.memcmp;return{memcmp:{...r,bytes:$.deserialize(t)[0]}}}function yn(e,t){return t.strategy.type==="blockhash"?{...t.strategy,signature:$.deserialize(e)[0]}:{...t.strategy,signature:$.deserialize(e)[0],nonceAccountPubkey:O(t.strategy.nonceAccountPubkey)}}function xn(e,t,r){if(!t&&!r)return e;let n={};return t&&(n.commitment=t),r&&(n={...n,...r}),e.push(n),e}function wn(e={},t,r){if(!t&&!r)return e;const n={...e};return t&&(n.commitment=t),r&&Object.assign(n,r),n}function Ze(e,t){return{install(r){r.rpc=typeof e=="string"?We(r,e,t):We(r,e)}}}const bn=(e,t=100)=>({...e,getAccounts:async(r,n)=>{const s=Or(r,t).map(a=>e.getAccounts(a,n));return(await Promise.all(s)).flat()}}),zn=(e=100)=>({install(t){t.rpc=bn(t.rpc,e)}});function Sn(e={}){return{tuple:pr,array:Y,map:ur,set:gr,option:hr,nullable:fr,struct:oe,enum:mr,dataEnum:dr,string:dt,bool:cr,unit:yr,u8:_,u16:rr,u32:ge,u64:nr,u128:sr,i8:Zt,i16:Yt,i32:Qt,i64:er,i128:tr,f32:Wt,f64:Xt,bytes:we,publicKey:Pe}}const vn=(e={})=>({install(t){t.serializer=Sn(e)}}),Ye=128,En=127;function In(){const e=h=>{const I=Jr(h),B=ht(I),T=new rt(I,h.signatures);return{message:B,serializedMessage:n(B),signatures:T.signatures}},t=h=>i().serialize(h),r=h=>i().deserialize(h)[0],n=h=>a().serialize(h),s=h=>a().deserialize(h)[0],i=()=>({...Lt(oe([["signatures",Y(we({size:64}),{size:Z()})],["serializedMessage",we()]]),h=>h,h=>({...h,message:s(h.serializedMessage)})),description:"Transaction"}),a=()=>({description:"TransactionMessage",fixedSize:null,maxSize:null,serialize:h=>o(h.version).serialize(h),deserialize:(h,I=0)=>{const[B]=l().deserialize(h,I);return o(B).deserialize(h,I)}}),o=h=>oe([["version",l()],["header",d()],["accounts",Y(Pe(),{size:Z()})],["blockhash",dt({encoding:$,size:32})],["instructions",Y(m(),{size:Z()})],["addressLookupTables",Y(u(),{size:h==="legacy"?0:Z()})]]),l=()=>({description:"TransactionVersion",fixedSize:null,maxSize:1,serialize:h=>h==="legacy"?new Uint8Array([]):new Uint8Array([Ye|h]),deserialize:(h,I=0)=>{const B=h.slice(I);if(B.length===0||(B[0]&Ye)===0)return["legacy",I];const T=B[0]&En;if(T>0)throw new Re(`Unsupported transaction version: ${T}.`);return[T,I+1]}}),d=()=>oe([["numRequiredSignatures",_()],["numReadonlySignedAccounts",_()],["numReadonlyUnsignedAccounts",_()]]),m=()=>oe([["programIndex",_()],["accountIndexes",Y(_(),{size:Z()})],["data",we({size:Z()})]]),u=()=>oe([["publicKey",Pe()],["writableIndexes",Y(_(),{size:Z()})],["readonlyIndexes",Y(_(),{size:Z()})]]);return{create:e,serialize:t,deserialize:r,serializeMessage:n,deserializeMessage:s}}const An=()=>({install(e){e.transactions=In()}});function Qe(e,t){return{install(r){r.use(vn()),r.use(gn()),r.use(fn()),r.use(Hr()),r.use(Wr()),r.use(typeof e=="string"?Ze(e,t):Ze(e)),r.use(zn(t?.getAccountsChunkSize)),r.use(An())}}}function Tn(e,t){return Fr().use(Qe(e,t))}async function Nn(e,t){try{const r=Tn(e.rpcEndpoint),n=le(t.toString()),s=await Bt.fetchMetadata(r,n);let i=null;s.creators&&(i=s.creators.value.map(l=>({address:new ce(l.address),verified:l.verified,share:l.share})));let a=null;if(s.collection){const o=s.collection.value;a={verified:o.verified,key:new ce(o.key)}}return{mint:t,data:{name:s.name,symbol:s.symbol,uri:s.uri,sellerFeeBasisPoints:s.sellerFeeBasisPoints,creators:i},primarySaleHappened:s.primarySaleHappened,isMutable:s.isMutable,collection:a}}catch{return null}}const Bn=Nt("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90",warning:"text-yellow-500 bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-yellow-500/90 border-yellow-500 dark:bg-yellow-900/10"}},defaultVariants:{variant:"default"}});function jn({className:e,variant:t,...r}){return c.jsx("div",{"data-slot":"alert",role:"alert",className:nt(Bn({variant:t}),e),...r})}function Pn({className:e,...t}){return c.jsx("div",{"data-slot":"alert-description",className:nt("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}function Mn(){const{connection:e}=bt(),t=zt(),r=jt(t,e),[n,s]=V.useState(!0),[i,a]=V.useState(!1),[o,l]=V.useState(null),[d,m]=V.useState([]),[u,h]=V.useState(new Set),[I,B]=V.useState(new Set),[T,S]=V.useState(new Set),[A,j]=V.useState(new Map);V.useEffect(()=>{(async()=>{if(!r||!t.publicKey){s(!1);return}if(!i)try{s(!0),l(null);const f=await r.getPaymentPoliciesByUser(t.publicKey),v=new Map,y=new Map;for(const w of f){const X=w.account.userPayment.toString();if(!v.has(X)){const F=await r.getUserPayment(w.account.userPayment);if(F){v.set(X,{userPaymentAddress:w.account.userPayment,userPayment:F,policies:[]});const pe=F.tokenMint.toString();if(!y.has(pe))try{const fe=await Tt(e,F.tokenMint),Me=await Nn(e,F.tokenMint);y.set(pe,{decimals:fe.decimals,metadata:Me??void 0,symbol:Me?.data.symbol})}catch(fe){console.error("Error fetching mint info:",fe)}}}const te=v.get(X);te&&te.policies.push(w)}y.set("4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU",{decimals:6,symbol:"USDC"}),m(Array.from(v.values())),j(y),a(!0)}catch(f){const v=f instanceof Error?f.message:"Failed to fetch payment policies";l(v),console.error("Error fetching payment policies:",f)}finally{s(!1)}})()},[r,i,e]);const U=g=>{const f=g.policyType;return f.subscription?"Subscription":f.oneTime?"One Time":f.installment?"Installment":"Unknown"},k=g=>{const f=g.policyType;let v=0;if(f.subscription?v=Number(f.subscription.intervalSeconds):f.installment&&(v=Number(f.installment.intervalSeconds)),v===0)return"N/A";const y=Ut({start:0,end:v*1e3});return $t(y,{format:["years","months","weeks","days","hours","minutes","seconds"]})},K=g=>{const f=g.policyType.subscription.nextPaymentDue;if(!f)return"N/A";const v=new Date(f.toNumber()*1e3);return v<new Date?"Overdue":Rt(v,{addSuffix:!0})},x=g=>{if(!g.memo||g.memo.length===0)return"";try{const f=new TextDecoder,v=g.memo.filter(y=>y!==0);return f.decode(new Uint8Array(v))}catch{return""}},b=g=>{const f=g.status;return f.active?"Active":f.paused?"Paused":f.cancelled?"Cancelled":f.completed?"Completed":f.failed?"Failed":"Unknown"},p=g=>{const f=g.policyType;let v=null;return f.subscription&&(v=Number(f.subscription.amount)),v===null?null:v.toString()},z=(g,f)=>{if(!g)return"N/A";const v=A.get(f.toString());if(!v)return g;const w=(Number(g)/Math.pow(10,v.decimals)).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:v.decimals});return v.symbol?`${w} ${v.symbol}`:w},E=g=>{const f=g.policyType.subscription.nextPaymentDue;return f?new Date(f.toNumber()*1e3)<=new Date:!1},L=async(g,f,v)=>{if(!r||!t.publicKey){R.error("Wallet not connected");return}try{const y=await r.getPaymentGateway(f.gateway);if(!y){R.error("Gateway not found");return}if(y.authority.toString()!==t.publicKey.toString()&&v.owner.toString()!=t.publicKey.toString()){R.error("Only the gateway authority can execute payments");return}h(F=>new Set(F).add(g.toString()));const w=new Ee;(await r.executePayment(g)).map(F=>w.add(F));const te=await r.provider.sendAndConfirm(w);R.success(`Payment executed successfully! TX: ${te}`),a(!1)}catch(y){console.error("Error executing payment:",y),R.error(y instanceof Error?y.message:"Failed to execute payment")}finally{h(y=>{const w=new Set(y);return w.delete(g.toString()),w})}},ee=async(g,f,v)=>{if(!r||!t.publicKey){R.error("Wallet not connected");return}if(v.owner.toString()!==t.publicKey.toString()){R.error("Only the policy owner can change status");return}try{B(fe=>new Set(fe).add(g.toString()));const w=f.status.active,X=w?{paused:{}}:{active:{}},te=new Ee,F=await r.changePaymentPolicyStatus(v.tokenMint,f.policyId,X);te.add(F),await r.provider.sendAndConfirm(te);const pe=w?"paused":"resumed";R.success(`Payment policy ${pe} successfully!`),a(!1)}catch(y){console.error("Error toggling payment policy status:",y),R.error(y instanceof Error?y.message:"Failed to toggle policy status")}finally{B(y=>{const w=new Set(y);return w.delete(g.toString()),w})}},W=async(g,f,v)=>{if(!r||!t.publicKey){R.error("Wallet not connected");return}if(v.owner.toString()!==t.publicKey.toString()){R.error("Only the policy owner can delete the policy");return}if(confirm("Are you sure you want to delete this payment policy? This action cannot be undone."))try{S(X=>new Set(X).add(g.toString()));const y=new Ee,w=await r.deletePaymentPolicy(v.tokenMint,f.policyId);y.add(w),await r.provider.sendAndConfirm(y),R.success("Payment policy deleted successfully!"),a(!1)}catch(y){console.error("Error deleting payment policy:",y),R.error(y instanceof Error?y.message:"Failed to delete policy")}finally{S(y=>{const w=new Set(y);return w.delete(g.toString()),w})}};return c.jsx("div",{className:"container mx-auto px-4 py-8",children:c.jsxs("div",{className:"max-w-7xl mx-auto",children:[n&&c.jsxs("div",{className:"flex justify-center items-center min-h-[400px]",children:[c.jsx(wt,{size:"lg"}),c.jsx("span",{className:"ml-4 text-gray-600",children:"Loading payment policies..."})]}),!n&&o&&c.jsx(jn,{variant:"destructive",children:c.jsx(Pn,{children:o})}),!n&&!o&&d.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx("p",{className:"text-gray-600 text-lg",children:"No payment policies found"}),c.jsx("p",{className:"text-gray-500 mt-2",children:"Create your first payment policy to get started"})]}),!n&&!o&&d.length>0&&c.jsxs("div",{className:"w-full space-y-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold mb-2",children:"User Payments & Policies"}),c.jsx("p",{className:"text-gray-600",children:"View all user payment accounts and their associated policies"})]}),d.map(({userPaymentAddress:g,userPayment:f,policies:v})=>c.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-4",children:[c.jsx("h3",{className:"text-lg font-semibold mb-3",children:"User Payment Account"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Address"}),c.jsx("div",{className:"font-mono text-sm mt-1",children:c.jsx(he,{publicKey:g})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Owner"}),c.jsx("div",{className:"font-mono text-sm mt-1",children:c.jsx(he,{publicKey:f.owner})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Token Mint"}),c.jsx("div",{className:"font-mono text-sm mt-1",children:c.jsx(he,{publicKey:f.tokenMint})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Active Policies"}),c.jsx("div",{className:"text-lg font-semibold mt-1",children:f.activePoliciesCount})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),c.jsx("div",{className:"text-sm font-semibold mt-1",children:f.isActive?c.jsx("span",{className:"text-green-600",children:"Active"}):c.jsx("span",{className:"text-red-600",children:"Inactive"})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Created At"}),c.jsx("div",{className:"text-sm mt-1",children:new Date(f.createdAt.toNumber()*1e3).toLocaleString()})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Updated At"}),c.jsx("div",{className:"text-sm mt-1",children:new Date(f.updatedAt.toNumber()*1e3).toLocaleString()})]})]})]}),c.jsxs("div",{className:"p-4",children:[c.jsxs("h4",{className:"text-md font-semibold mb-3",children:["Payment Policies (",v.length,")"]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border-collapse",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-900",children:[c.jsx("th",{className:"border p-2 text-left text-xs",children:"Policy Address"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"ID"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Type"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Amount"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Recipient"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Total Paid"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Interval"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Next Payment"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Status"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Payments"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Memo"}),c.jsx("th",{className:"border p-2 text-left text-xs",children:"Actions"})]})}),c.jsx("tbody",{children:v.map(({publicKey:y,account:w})=>c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-900",children:[c.jsx("td",{className:"border p-2 font-mono text-xs",children:c.jsx(he,{publicKey:y})}),c.jsx("td",{className:"border p-2 text-center text-sm",children:w.policyId}),c.jsx("td",{className:"border p-2 text-sm",children:U(w)}),c.jsx("td",{className:"border p-2 text-sm",children:z(p(w),f.tokenMint)}),c.jsx("td",{className:"border p-2 font-mono text-xs",children:c.jsx(he,{publicKey:w.recipient})}),c.jsx("td",{className:"border p-2 font-mono text-xs",children:z(w.totalPaid.toString(),f.tokenMint)}),c.jsx("td",{className:"border p-2 text-sm",children:k(w)}),c.jsx("td",{className:"border p-2 text-sm",children:K(w)}),c.jsx("td",{className:"border p-2",children:c.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:b(w)})}),c.jsx("td",{className:"border p-2 text-center text-sm",children:w.paymentCount}),c.jsx("td",{className:"border p-2 text-xs",children:x(w)}),c.jsx("td",{className:"border p-2",children:c.jsxs("div",{className:"flex gap-1",children:[c.jsx(Se,{size:"sm",isIconOnly:!0,color:"primary",variant:"flat",isDisabled:!E(w)||u.has(y.toString()),isLoading:u.has(y.toString()),onPress:()=>L(y,w,f),children:c.jsx(Pt,{className:"h-4 w-4"})}),c.jsx(Se,{size:"sm",isIconOnly:!0,color:b(w)==="Active"?"warning":"success",variant:"flat",isDisabled:I.has(y.toString()),isLoading:I.has(y.toString()),onPress:()=>ee(y,w,f),children:b(w)==="Active"?c.jsx(Ot,{className:"h-4 w-4"}):c.jsx(kt,{className:"h-4 w-4"})}),c.jsx(Se,{size:"sm",isIconOnly:!0,color:"danger",variant:"flat",isDisabled:T.has(y.toString()),isLoading:T.has(y.toString()),onPress:()=>W(y,w,f),children:c.jsx(Dt,{className:"h-4 w-4"})})]})})]},y.toString()))})]})})]})]},g.toString())),c.jsxs("div",{className:"text-gray-600 text-sm",children:["Total user payments: ",c.jsx("span",{className:"font-semibold",children:d.length})," | ","Total policies:"," ",c.jsx("span",{className:"font-semibold",children:d.reduce((g,f)=>g+f.policies.length,0)})]})]})]})})}export{Mn as default};

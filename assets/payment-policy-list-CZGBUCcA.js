import{j as l,C as xt,D as wt,c as Se,e as $}from"./ui-vendor-CWNXZ0rB.js";import{L as bt,J as zt,r as V}from"./wallet-adapter-CzNbDF3J.js";import{P as ce,b as St,c as Et,M as et,d as tt,A as vt,V as rt,e as Fe,K as Ee,g as It,C as At,f as Tt,T as ve}from"./solana-vendor-DivO4xON.js";import{s as Nt,u as Bt}from"./copy-DWk-gr8M.js";import{P as he,a as jt,b as Pt,R as Ot,T as kt,i as Dt,f as Ut,c as $t}from"./intervalToDuration-BS-j0BtS.js";import"./createLucideIcon-BvppSokg.js";const nt=e=>({__option:"Some",value:e}),Be=()=>({__option:"None"}),Rt=e=>e&&typeof e=="object"&&"__option"in e&&(e.__option==="Some"&&"value"in e||e.__option==="None"),Ie=e=>e.__option==="Some",_t=e=>e!==null?nt(e):Be();class Ct extends Error{name="InvalidBaseStringError";constructor(t,r,n){const s=`Expected a string of base ${r}, got [${t}].`;super(s),this.cause=n}}const Mt=e=>{const t=e.length,r=BigInt(t);return{description:`base${t}`,fixedSize:null,maxSize:null,serialize(n){if(!n.match(new RegExp(`^[${e}]*$`)))throw new Ct(n,t);if(n==="")return new Uint8Array;const s=[...n];let i=s.findIndex(u=>u!==e[0]);i=i===-1?s.length:i;const o=Array(i).fill(0);if(i===s.length)return Uint8Array.from(o);const a=s.slice(i);let c=0n,d=1n;for(let u=a.length-1;u>=0;u-=1)c+=d*BigInt(e.indexOf(a[u])),d*=r;const m=[];for(;c>0n;)m.unshift(Number(c%256n)),c/=256n;return Uint8Array.from(o.concat(m))},deserialize(n,s=0){if(n.length===0)return["",0];const i=n.slice(s);let o=i.findIndex(m=>m!==0);o=o===-1?i.length:o;const a=e[0].repeat(o);if(o===i.length)return[a,n.length];let c=i.slice(o).reduce((m,u)=>m*256n+BigInt(u),0n);const d=[];for(;c>0n;)d.unshift(e[Number(c%r)]),c/=r;return[a+d.join(""),n.length]}}},R=Mt("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),C=e=>{const t=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(t);let n=0;return e.forEach(s=>{r.set(s,n),n+=s.length}),r},Ft=(e,t)=>{if(e.length>=t)return e;const r=new Uint8Array(t).fill(0);return r.set(e),r},Ke=(e,t)=>Ft(e.slice(0,t),t);class ie extends Error{name="DeserializingEmptyBufferError";constructor(t){super(`Serializer [${t}] cannot deserialize empty buffers.`)}}class me extends Error{name="NotEnoughBytesError";constructor(t,r,n){super(`Serializer [${t}] expected ${r} bytes, got ${n}.`)}}class ke extends Error{name="ExpectedFixedSizeSerializerError";constructor(t){t??="Expected a fixed-size serializer, got a variable-size one.",super(t)}}function st(e,t,r){return{description:r??`fixed(${t}, ${e.description})`,fixedSize:t,maxSize:t,serialize:n=>Ke(e.serialize(n),t),deserialize:(n,s=0)=>{if(n=n.slice(s,s+t),n.length<t)throw new me("fixSerializer",t,n.length);e.fixedSize!==null&&(n=Ke(n,e.fixedSize));const[i]=e.deserialize(n,0);return[i,s+t]}}}function Kt(e,t,r){return{description:e.description,fixedSize:e.fixedSize,maxSize:e.maxSize,serialize:n=>e.serialize(t(n)),deserialize:(n,s=0)=>{const[i,o]=e.deserialize(n,s);return r?[r(i,n,s),o]:[i,o]}}}const Lt=e=>e.replace(/\u0000/g,""),it={description:"utf8",fixedSize:null,maxSize:null,serialize(e){return new TextEncoder().encode(e)},deserialize(e,t=0){const r=new TextDecoder().decode(e.slice(t));return[Lt(r),e.length]}};class pe extends Error{name="InvalidPublicKeyError";constructor(t,r){r=r?`. ${r}`:"",super(`The provided public key is invalid: ${t}${r}`),this.invalidPublicKey=t}}const we=32;function le(e,t=!0){const r=typeof e=="string"?e:typeof e=="object"&&"publicKey"in e?e.publicKey:typeof e=="object"&&"toBase58"in e?e.toBase58():Array.isArray(e)?e[0]:R.deserialize(e)[0];return t&&ot(r),r}const ye=e=>{try{return ot(e),!0}catch{return!1}};function ot(e){if(typeof e!="string")throw new pe(e,"Public keys must be strings.");De(e)}const De=e=>{if(e.length<32||e.length>44)throw new pe(e,"Public keys must be between 32 and 44 characters.");let t;try{t=R.serialize(e)}catch{throw new pe(e,"Public keys must be base58 encoded.")}if(t.length!==we)throw new pe(e,`Public keys must be ${we} bytes.`);return t};let je;(function(e){e.Little="le",e.Big="be"})(je||(je={}));class Ht extends RangeError{name="NumberOutOfRangeError";constructor(t,r,n,s){super(`Serializer [${t}] expected number to be between ${r} and ${n}, got ${s}.`)}}function M(e){let t,r=e.name;return e.size>1&&(t=!("endian"in e.options)||e.options.endian===je.Little,r+=t?"(le)":"(be)"),{description:e.options.description??r,fixedSize:e.size,maxSize:e.size,serialize(n){e.range&&at(e.name,e.range[0],e.range[1],n);const s=new ArrayBuffer(e.size);return e.set(new DataView(s),n,t),new Uint8Array(s)},deserialize(n,s=0){const i=n.slice(s,s+e.size);qt("i8",i,e.size);const o=Jt(i);return[e.get(o,t),s+e.size]}}}const Vt=e=>e.buffer.slice(e.byteOffset,e.byteLength+e.byteOffset),Jt=e=>new DataView(Vt(e)),at=(e,t,r,n)=>{if(n<t||n>r)throw new Ht(e,t,r,n)},qt=(e,t,r)=>{if(t.length===0)throw new ie(e);if(t.length<r)throw new me(e,r,t.length)},Gt=(e={})=>M({name:"f32",size:4,set:(t,r,n)=>t.setFloat32(0,Number(r),n),get:(t,r)=>t.getFloat32(0,r),options:e}),Wt=(e={})=>M({name:"f64",size:8,set:(t,r,n)=>t.setFloat64(0,Number(r),n),get:(t,r)=>t.getFloat64(0,r),options:e}),Xt=(e={})=>M({name:"i8",size:1,range:[-+"0x7f"-1,+"0x7f"],set:(t,r)=>t.setInt8(0,Number(r)),get:t=>t.getInt8(0),options:e}),Zt=(e={})=>M({name:"i16",size:2,range:[-+"0x7fff"-1,+"0x7fff"],set:(t,r,n)=>t.setInt16(0,Number(r),n),get:(t,r)=>t.getInt16(0,r),options:e}),Yt=(e={})=>M({name:"i32",size:4,range:[-+"0x7fffffff"-1,+"0x7fffffff"],set:(t,r,n)=>t.setInt32(0,Number(r),n),get:(t,r)=>t.getInt32(0,r),options:e}),Qt=(e={})=>M({name:"i64",size:8,range:[-BigInt("0x7fffffffffffffff")-1n,BigInt("0x7fffffffffffffff")],set:(t,r,n)=>t.setBigInt64(0,BigInt(r),n),get:(t,r)=>t.getBigInt64(0,r),options:e}),er=(e={})=>M({name:"i128",size:16,range:[-BigInt("0x7fffffffffffffffffffffffffffffff")-1n,BigInt("0x7fffffffffffffffffffffffffffffff")],set:(t,r,n)=>{const s=n?8:0,i=n?0:8,o=0xffffffffffffffffn;t.setBigInt64(s,BigInt(r)>>64n,n),t.setBigUint64(i,BigInt(r)&o,n)},get:(t,r)=>{const n=r?8:0,s=r?0:8,i=t.getBigInt64(n,r),o=t.getBigUint64(s,r);return(i<<64n)+o},options:e}),_=(e={})=>M({name:"u8",size:1,range:[0,+"0xff"],set:(t,r)=>t.setUint8(0,Number(r)),get:t=>t.getUint8(0),options:e}),tr=(e={})=>M({name:"u16",size:2,range:[0,+"0xffff"],set:(t,r,n)=>t.setUint16(0,Number(r),n),get:(t,r)=>t.getUint16(0,r),options:e}),ge=(e={})=>M({name:"u32",size:4,range:[0,+"0xffffffff"],set:(t,r,n)=>t.setUint32(0,Number(r),n),get:(t,r)=>t.getUint32(0,r),options:e}),rr=(e={})=>M({name:"u64",size:8,range:[0,BigInt("0xffffffffffffffff")],set:(t,r,n)=>t.setBigUint64(0,BigInt(r),n),get:(t,r)=>t.getBigUint64(0,r),options:e}),nr=(e={})=>M({name:"u128",size:16,range:[0,BigInt("0xffffffffffffffffffffffffffffffff")],set:(t,r,n)=>{const s=n?8:0,i=n?0:8,o=0xffffffffffffffffn;t.setBigUint64(s,BigInt(r)>>64n,n),t.setBigUint64(i,BigInt(r)&o,n)},get:(t,r)=>{const n=r?8:0,s=r?0:8,i=t.getBigUint64(n,r),o=t.getBigUint64(s,r);return(i<<64n)+o},options:e}),Z=(e={})=>({description:e.description??"shortU16",fixedSize:null,maxSize:3,serialize:t=>{at("shortU16",0,65535,t);const r=[0];for(let n=0;;n+=1){const s=t>>n*7;if(s===0)break;const i=127&s;r[n]=i,n>0&&(r[n-1]|=128)}return new Uint8Array(r)},deserialize:(t,r=0)=>{let n=0,s=0;for(;++s;){const i=s-1,o=t[r+i],a=127&o;if(n|=a<<i*7,(o&128)===0)break}return[n,r+s]}});class be extends Error{name="InvalidNumberOfItemsError";constructor(t,r,n){super(`Expected [${t}] to have ${r} items, got ${n}.`)}}class sr extends Error{name="UnrecognizedArrayLikeSerializerSizeError";constructor(t){super(`Unrecognized array-like serializer size: ${JSON.stringify(t)}`)}}class ir extends Error{name="InvalidDataEnumVariantError";constructor(t,r){super(`Invalid data enum variant. Expected one of [${r.join(", ")}], got "${t}".`)}}class or extends Error{name="InvalidScalarEnumVariantError";constructor(t,r,n,s){super(`Invalid scalar enum variant. Expected one of [${r.join(", ")}] or a number between ${n} and ${s}, got "${t}".`)}}class ct extends RangeError{name="EnumDiscriminatorOutOfRangeError";constructor(t,r,n){super(`Enum discriminator out of range. Expected a number between ${r} and ${n}, got ${t}.`)}}function G(e){return e.reduce((t,r)=>t===null||r===null?null:t+r,0)}function Ue(e,t,r){if(typeof e=="number")return[e,r];if(typeof e=="object")return e.deserialize(t,r);throw new sr(e)}function oe(e){return typeof e=="object"?e.description:`${e}`}function de(e,t){if(typeof e!="number")return null;if(e===0)return 0;const r=G(t);return r===null?null:r*e}function $e(e,t){return typeof e=="object"?e.serialize(t):new Uint8Array}function Y(e,t={}){const r=t.size??ge();return{description:t.description??`array(${e.description}; ${oe(r)})`,fixedSize:de(r,[e.fixedSize]),maxSize:de(r,[e.maxSize]),serialize:n=>{if(typeof r=="number"&&n.length!==r)throw new be("array",r,n.length);return C([$e(r,n.length),...n.map(s=>e.serialize(s))])},deserialize:(n,s=0)=>{const i=[];if(typeof r=="object"&&n.slice(s).length===0)return[i,s];if(r==="remainder"){for(;s<n.length;){const[c,d]=e.deserialize(n,s);i.push(c),s=d}return[i,s]}const[o,a]=Ue(r,n,s);s=a;for(let c=0;c<o;c+=1){const[d,m]=e.deserialize(n,s);i.push(d),s=m}return[i,s]}}}function ar(e={}){const t=e.size??_();if(t.fixedSize===null)throw new ke("Serializer [bool] requires a fixed size.");return{description:e.description??`bool(${t.description})`,fixedSize:t.fixedSize,maxSize:t.fixedSize,serialize:r=>t.serialize(r?1:0),deserialize:(r,n=0)=>{if(r.slice(n).length===0)throw new ie("bool");const[s,i]=t.deserialize(r,n);return[s===1,i]}}}function xe(e={}){const t=e.size??"variable",r=e.description??`bytes(${oe(t)})`,n={description:r,fixedSize:null,maxSize:null,serialize:s=>new Uint8Array(s),deserialize:(s,i=0)=>{const o=s.slice(i);return[o,i+o.length]}};return t==="variable"?n:typeof t=="number"?st(n,t,r):{description:r,fixedSize:null,maxSize:null,serialize:s=>{const i=n.serialize(s),o=t.serialize(i.length);return C([o,i])},deserialize:(s,i=0)=>{if(s.slice(i).length===0)throw new ie("bytes");const[o,a]=t.deserialize(s,i),c=Number(o);i=a;const d=s.slice(i,i+c);if(d.length<c)throw new me("bytes",c,d.length);const[m,u]=n.deserialize(d);return i+=u,[m,i]}}}function cr(e){return e.reduce((t,r)=>t===null||r===null?null:Math.max(t,r),0)}function lr(e,t={}){const r=t.size??_(),n=e.map(([a,c])=>`${String(a)}${c?`: ${c.description}`:""}`).join(", "),i=e.every((a,c,d)=>a[1].fixedSize===d[0][1].fixedSize)?e[0][1].fixedSize:null,o=cr(e.map(([,a])=>a.maxSize));return{description:t.description??`dataEnum(${n}; ${r.description})`,fixedSize:e.length===0?r.fixedSize:G([r.fixedSize,i]),maxSize:e.length===0?r.maxSize:G([r.maxSize,o]),serialize:a=>{const c=e.findIndex(([h])=>a.__kind===h);if(c<0)throw new ir(a.__kind,e.map(([h])=>h));const d=r.serialize(c),u=e[c][1].serialize(a);return C([d,u])},deserialize:(a,c=0)=>{if(a.slice(c).length===0)throw new ie("dataEnum");const[d,m]=r.deserialize(a,c);c=m;const u=e[Number(d)]??null;if(!u)throw new ct(d,0,e.length-1);const[h,I]=u[1].deserialize(a,c);return c=I,[{__kind:u[0],...h??{}},c]}}}function dr(e,t,r={}){const n=r.size??ge();return{description:r.description??`map(${e.description}, ${t.description}; ${oe(n)})`,fixedSize:de(n,[e.fixedSize,t.fixedSize]),maxSize:de(n,[e.maxSize,t.maxSize]),serialize:s=>{if(typeof n=="number"&&s.size!==n)throw new be("map",n,s.size);const i=Array.from(s,([o,a])=>C([e.serialize(o),t.serialize(a)]));return C([$e(n,s.size),...i])},deserialize:(s,i=0)=>{const o=new Map;if(typeof n=="object"&&s.slice(i).length===0)return[o,i];if(n==="remainder"){for(;i<s.length;){const[d,m]=e.deserialize(s,i);i=m;const[u,h]=t.deserialize(s,i);i=h,o.set(d,u)}return[o,i]}const[a,c]=Ue(n,s,i);i=c;for(let d=0;d<a;d+=1){const[m,u]=e.deserialize(s,i);i=u;const[h,I]=t.deserialize(s,i);i=I,o.set(m,h)}return[o,i]}}}function ur(e,t={}){const r=t.prefix??_(),n=t.fixed??!1;let s=`; ${oe(r)}`,i=e.fixedSize===0?r.fixedSize:null;if(n){if(e.fixedSize===null||r.fixedSize===null)throw new ke("Fixed nullables can only be used with fixed-size serializers");s+="; fixed",i=r.fixedSize+e.fixedSize}return{description:t.description??`nullable(${e.description+s})`,fixedSize:i,maxSize:G([r.maxSize,e.maxSize]),serialize:o=>{const a=r.serialize(+(o!==null));if(n){const d=e.fixedSize,m=o!==null?e.serialize(o).slice(0,d):new Uint8Array(d).fill(0);return C([a,m])}const c=o!==null?e.serialize(o):new Uint8Array;return C([a,c])},deserialize:(o,a=0)=>{if(o.slice(a).length===0)return[null,a];const c=a+(r.fixedSize??0)+(e.fixedSize??0),[d,m]=r.deserialize(o,a);if(a=m,d===0)return[null,n?c:a];const[u,h]=e.deserialize(o,a);return a=h,[u,n?c:a]}}}function fr(e,t={}){const r=t.prefix??_(),n=t.fixed??!1;let s=`; ${oe(r)}`,i=e.fixedSize===0?r.fixedSize:null;if(n){if(e.fixedSize===null||r.fixedSize===null)throw new ke("Fixed options can only be used with fixed-size serializers");s+="; fixed",i=r.fixedSize+e.fixedSize}return{description:t.description??`option(${e.description+s})`,fixedSize:i,maxSize:G([r.maxSize,e.maxSize]),serialize:o=>{const a=Rt(o)?o:_t(o),c=r.serialize(Number(Ie(a)));if(n){const m=e.fixedSize,u=Ie(a)?e.serialize(a.value).slice(0,m):new Uint8Array(m).fill(0);return C([c,u])}const d=Ie(a)?e.serialize(a.value):new Uint8Array;return C([c,d])},deserialize:(o,a=0)=>{if(o.slice(a).length===0)return[Be(),a];const c=a+(r.fixedSize??0)+(e.fixedSize??0),[d,m]=r.deserialize(o,a);if(a=m,d===0)return[Be(),n?c:a];const[u,h]=e.deserialize(o,a);return a=h,[nt(u),n?c:a]}}}function Pe(e={}){return{description:e.description??"publicKey",fixedSize:32,maxSize:32,serialize:t=>De(le(t)),deserialize:(t,r=0)=>{const n=t.slice(r,r+32);if(n.length===0)throw new ie("publicKey");if(n.length<we)throw new me("publicKey",we,n.length);return[le(n),r+32]}}}function hr(e,t={}){const r=t.size??_(),n=Object.keys(e),s=Object.values(e),i=s.some(u=>typeof u=="number"),o=s.filter(u=>typeof u=="string").join(", "),a=0,c=i?s.length/2-1:s.length-1,d=i?[...n]:[...new Set([...n,...s])];function m(u){const h=typeof u=="number"&&(u<a||u>c),I=typeof u=="string"&&!d.includes(u);if(h||I)throw new or(u,d,a,c)}return{description:t.description??`enum(${o}; ${r.description})`,fixedSize:r.fixedSize,maxSize:r.maxSize,serialize:u=>{if(m(u),typeof u=="number")return r.serialize(u);const h=s.indexOf(u);return h>=0?r.serialize(h):r.serialize(n.indexOf(u))},deserialize:(u,h=0)=>{if(u.slice(h).length===0)throw new ie("enum");const[I,B]=r.deserialize(u,h),T=Number(I);if(h=B,T<a||T>c)throw new ct(T,a,c);return[i?T:s[T],h]}}}function mr(e,t={}){const r=t.size??ge();return{description:t.description??`set(${e.description}; ${oe(r)})`,fixedSize:de(r,[e.fixedSize]),maxSize:de(r,[e.maxSize]),serialize:n=>{if(typeof r=="number"&&n.size!==r)throw new be("set",r,n.size);const s=Array.from(n,i=>e.serialize(i));return C([$e(r,n.size),...s])},deserialize:(n,s=0)=>{const i=new Set;if(typeof r=="object"&&n.slice(s).length===0)return[i,s];if(r==="remainder"){for(;s<n.length;){const[c,d]=e.deserialize(n,s);i.add(c),s=d}return[i,s]}const[o,a]=Ue(r,n,s);s=a;for(let c=0;c<o;c+=1){const[d,m]=e.deserialize(n,s);i.add(d),s=m}return[i,s]}}}function lt(e={}){const t=e.size??ge(),r=e.encoding??it,n=e.description??`string(${r.description}; ${oe(t)})`;return t==="variable"?{...r,description:n}:typeof t=="number"?st(r,t,n):{description:n,fixedSize:null,maxSize:null,serialize:s=>{const i=r.serialize(s),o=t.serialize(i.length);return C([o,i])},deserialize:(s,i=0)=>{if(s.slice(i).length===0)throw new ie("string");const[o,a]=t.deserialize(s,i),c=Number(o);i=a;const d=s.slice(i,i+c);if(d.length<c)throw new me("string",c,d.length);const[m,u]=r.deserialize(d);return i+=u,[m,i]}}}function ae(e,t={}){const r=e.map(([n,s])=>`${String(n)}: ${s.description}`).join(", ");return{description:t.description??`struct(${r})`,fixedSize:G(e.map(([,n])=>n.fixedSize)),maxSize:G(e.map(([,n])=>n.maxSize)),serialize:n=>{const s=e.map(([i,o])=>o.serialize(n[i]));return C(s)},deserialize:(n,s=0)=>{const i={};return e.forEach(([o,a])=>{const[c,d]=a.deserialize(n,s);s=d,i[o]=c}),[i,s]}}}function gr(e,t={}){const r=e.map(n=>n.description).join(", ");return{description:t.description??`tuple(${r})`,fixedSize:G(e.map(n=>n.fixedSize)),maxSize:G(e.map(n=>n.maxSize)),serialize:n=>{if(n.length!==e.length)throw new be("tuple",e.length,n.length);return C(e.map((s,i)=>s.serialize(n[i])))},deserialize:(n,s=0)=>{const i=[];return e.forEach(o=>{const[a,c]=o.deserialize(n,s);i.push(a),s=c}),[i,s]}}}function pr(e={}){return{description:e.description??"unit",fixedSize:0,maxSize:0,serialize:()=>new Uint8Array,deserialize:(t,r=0)=>[void 0,r]}}const yr=R;class dt extends Error{name="UmiError";constructor(t,r,n,s){super(t),this.source=r,this.sourceDetails=n,this.cause=s,this.message=`${this.message}

Source: ${this.getFullSource()}${this.cause?`

Caused By: ${this.cause}`:""}
`}getCapitalizedSource(){return this.source==="sdk"||this.source==="rpc"?this.source.toUpperCase():this.source[0].toUpperCase()+this.source.slice(1)}getFullSource(){const t=this.getCapitalizedSource(),r=this.sourceDetails?` > ${this.sourceDetails}`:"";return t+r}toString(){return`[${this.name}] ${this.message}`}}class Re extends dt{name="SdkError";constructor(t,r){super(t,"sdk",void 0,r)}}const xr=128,Oe=e=>(e=typeof e=="object"?e.toString():e,BigInt(e)),ut=(e,t,r)=>({basisPoints:Oe(e),identifier:t,decimals:r}),re=e=>ut(e,"SOL",9),wr=e=>e.basisPoints===BigInt(0),br=["api.mainnet-beta.solana.com","ssc-dao.genesysgo.net"],zr=["api.devnet.solana.com","psytrbhymqlkfrhudd.dev.genesysgo.net"],Sr=["api.testnet.solana.com"],Er=["localhost","127.0.0.1"],vr=e=>{const t=new URL(e).hostname;return br.includes(t)?"mainnet-beta":zr.includes(t)?"devnet":Sr.includes(t)?"testnet":Er.includes(t)?"localnet":e.includes("mainnet")?"mainnet-beta":e.includes("devnet")?"devnet":e.includes("testnet")?"testnet":e.includes("local")?"localnet":"custom"};class Q extends Re{name="InterfaceImplementationMissingError";constructor(t,r){const n=t.replace(/Interface$/,""),s=`Tried using ${t} but no implementation of that interface was found. Make sure an implementation is registered, e.g. via "context.${r} = new My${n}();".`;super(s)}}function Ir(){const e=()=>{throw new Q("DownloaderInterface","downloader")};return{download:e,downloadJson:e}}function Ar(){const e=()=>{throw new Q("EddsaInterface","eddsa")};return{generateKeypair:e,createKeypairFromSecretKey:e,createKeypairFromSeed:e,isOnCurve:e,findPda:e,sign:e,verify:e}}function Tr(){return{send:()=>{throw new Q("HttpInterface","http")}}}function Nr(){const e=()=>{throw new Q("ProgramRepositoryInterface","programs")};return{has:e,get:e,getPublicKey:e,all:e,add:e,bind:e,unbind:e,clone:e,resolveError:e}}function Br(){const e=()=>{throw new Q("RpcInterface","rpc")};return{getEndpoint:e,getCluster:e,getAccount:e,getAccounts:e,getProgramAccounts:e,getBlockTime:e,getBalance:e,getRent:e,getSlot:e,getGenesisHash:e,getLatestBlockhash:e,getTransaction:e,getSignatureStatuses:e,accountExists:e,airdrop:e,call:e,sendTransaction:e,simulateTransaction:e,confirmTransaction:e}}function jr(){const e=()=>{throw new Q("SerializerInterface","serializer")};return{tuple:e,array:e,map:e,set:e,option:e,nullable:e,struct:e,enum:e,dataEnum:e,string:e,bool:e,unit:e,u8:e,u16:e,u32:e,u64:e,u128:e,i8:e,i16:e,i32:e,i64:e,i128:e,f32:e,f64:e,bytes:e,publicKey:e}}const Pr=(e,t)=>e.reduce((r,n,s)=>{const i=Math.floor(s/t);return r[i]||(r[i]=[]),r[i].push(n),r},[]);function Le(){const e=new Error("Trying to use a NullSigner. Did you forget to set a Signer on your Umi instance? See the `signerIdentity` method for more information."),t=()=>{throw e};return{get publicKey(){throw e},signMessage:t,signTransaction:t,signAllTransactions:t}}function Or(){const e=()=>{throw new Q("TransactionFactoryInterface","transactions")};return{create:e,serialize:e,deserialize:e,serializeMessage:e,deserializeMessage:e}}function kr(){const e=()=>{throw new Q("UploaderInterface","uploader")};return{upload:e,uploadJson:e,getUploadPrice:e}}const Dr=()=>({downloader:Ir(),eddsa:Ar(),http:Tr(),identity:Le(),payer:Le(),programs:Nr(),rpc:Br(),serializer:jr(),transactions:Or(),uploader:kr()}),Ur=e=>{if(typeof e=="string"||$r(e)){const t=new Date(e),r=Math.floor(t.getTime()/1e3);return Oe(r)}return Oe(e)},$r=e=>Object.prototype.toString.call(e)==="[object Date]",Rr=(e=20,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")=>{let r="";const n=t.length;for(let s=0;s<e;s+=1)r+=t.charAt(Math.floor(Math.random()*n));return r},_r=(e,t,r={})=>({buffer:typeof e=="string"?it.serialize(e):e,fileName:t,displayName:r.displayName??t,uniqueName:r.uniqueName??Rr(),contentType:r.contentType??null,extension:r.extension??Cr(t),tags:r.tags??[]}),Cr=e=>{const t=e.lastIndexOf(".");return t<0?null:e.slice(t+1)},He=()=>new J({method:"get",data:void 0,headers:{},url:""});class J{constructor(t){this.request=t}asJson(){return this.contentType("application/json")}asMultipart(){return this.contentType("multipart/form-data")}asForm(){return this.contentType("application/x-www-form-urlencoded")}accept(t){return this.withHeader("accept",t)}contentType(t){return this.withHeader("content-type",t)}userAgent(t){return this.withHeader("user-agent",t)}withToken(t,r="Bearer"){return this.withHeader("authorization",`${r} ${t}`)}withHeader(t,r){return this.withHeaders({[t]:r})}withHeaders(t){return new J({...this.request,headers:{...this.request.headers,...t}})}dontFollowRedirects(){return this.followRedirects(0)}followRedirects(t){return new J({...this.request,maxRedirects:t})}withoutTimeout(){return this.withTimeout(0)}withTimeout(t){return new J({...this.request,timeout:t})}withAbortSignal(t){return new J({...this.request,signal:t})}withEndpoint(t,r){return new J({...this.request,method:t,url:r})}withParams(t){const r=new URL(this.request.url),n=new URLSearchParams(t),s=new URLSearchParams(r.searchParams);return[...n.entries()].forEach(([i,o])=>{s.append(i,o)}),r.search=s.toString(),new J({...this.request,url:r.toString()})}withData(t){return new J({...this.request,data:t})}get(t){return this.withEndpoint("get",t)}post(t){return this.withEndpoint("post",t)}put(t){return this.withEndpoint("put",t)}patch(t){return this.withEndpoint("patch",t)}delete(t){return this.withEndpoint("delete",t)}get method(){return this.request.method}get url(){return this.request.url}get data(){return this.request.data}get headers(){return this.request.headers}get maxRedirects(){return this.request.maxRedirects}get timeout(){return this.request.timeout}get signal(){return this.request.signal}}const Mr=()=>({...Dr(),use(e){return e.install(this),this}});class Fr extends dt{name="ProgramError";constructor(t,r,n){super(t,"program",`${r.name} [${r.publicKey}]`,n),this.program=r,this.logs=n?.logs,this.logs&&(this.message+=`
Program Logs:
${this.logs.map(s=>`| ${s}`).join(`
`)}
`)}}function Kr(e){const t=async(s,i={})=>{const o=await e.http.send(He().get(s).withAbortSignal(i.signal));return _r(o.body,s)};return{download:async(s,i={})=>Promise.all(s.map(o=>t(o,i))),downloadJson:async(s,i={})=>(await e.http.send(He().get(s).withAbortSignal(i.signal))).data}}const Lr=()=>({install(e){e.downloader=Kr(e)}});function q(e){return e.toBase58()}function O(e){return new ce(e)}function Ve(e){return new St({keys:e.keys.map(t=>({...t,pubkey:O(t.pubkey)})),programId:O(e.programId),data:Et.Buffer.from(e.data)})}function Ae(e){return{publicKey:q(e.publicKey),secretKey:e.secretKey}}function ft(e){return{version:e.version,header:e.header,accounts:e.staticAccountKeys.map(q),blockhash:e.recentBlockhash,instructions:e.compiledInstructions.map(t=>({programIndex:t.programIdIndex,accountIndexes:t.accountKeyIndexes,data:new Uint8Array(t.data)})),addressLookupTables:e.addressTableLookups.map(t=>({publicKey:q(t.accountKey),writableIndexes:t.writableIndexes,readonlyIndexes:t.readonlyIndexes}))}}function Hr(e){return e.version==="legacy"?new et({header:e.header,accountKeys:e.accounts.map(O),recentBlockhash:e.blockhash,instructions:e.instructions.map(t=>({programIdIndex:t.programIndex,accounts:t.accountIndexes,data:yr.deserialize(t.data)[0]}))}):new tt({header:e.header,staticAccountKeys:e.accounts.map(O),recentBlockhash:e.blockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIndex,accountKeyIndexes:t.accountIndexes,data:t.data})),addressTableLookups:e.addressLookupTables.map(t=>({accountKey:O(t.publicKey),writableIndexes:t.writableIndexes,readonlyIndexes:t.readonlyIndexes}))})}function Vr(e){return e.version==="legacy"?et.compile({payerKey:O(e.payer),instructions:e.instructions.map(Ve),recentBlockhash:e.blockhash}):tt.compile({payerKey:O(e.payer),instructions:e.instructions.map(Ve),recentBlockhash:e.blockhash,addressLookupTableAccounts:e.addressLookupTables?.map(t=>new vt({key:O(t.publicKey),state:{addresses:t.addresses.map(O),authority:void 0,deactivationSlot:BigInt(`0x${"ff".repeat(8)}`),lastExtendedSlot:0,lastExtendedSlotStartIndex:0}}))})}function Jr(e){return new rt(Hr(e.message),e.signatures)}function qr(){return{generateKeypair:()=>Ae(Ee.generate()),createKeypairFromSecretKey:a=>Ae(Ee.fromSecretKey(a)),createKeypairFromSeed:a=>Ae(Ee.fromSeed(a)),isOnCurve:a=>ce.isOnCurve(O(le(a))),findPda:(a,c)=>{const[d,m]=ce.findProgramAddressSync(c,O(le(a)));return[q(d),m]},sign:(a,c)=>Fe.sign(a,c.secretKey.slice(0,32)),verify:(a,c,d)=>Fe.verify(c,a,De(d))}}const Gr=()=>({install(e){e.eddsa=qr()}});var Je={},P=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Je<"u"&&Je||{},D={searchParams:"URLSearchParams"in P,iterable:"Symbol"in P&&"iterator"in Symbol,blob:"FileReader"in P&&"Blob"in P&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in P,arrayBuffer:"ArrayBuffer"in P};function Wr(e){return e&&DataView.prototype.isPrototypeOf(e)}if(D.arrayBuffer)var Xr=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Zr=ArrayBuffer.isView||function(e){return e&&Xr.indexOf(Object.prototype.toString.call(e))>-1};function ue(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function _e(e){return typeof e!="string"&&(e=String(e)),e}function Ce(e){var t={next:function(){var r=e.shift();return{done:r===void 0,value:r}}};return D.iterable&&(t[Symbol.iterator]=function(){return t}),t}function N(e){this.map={},e instanceof N?e.forEach(function(t,r){this.append(r,t)},this):Array.isArray(e)?e.forEach(function(t){if(t.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+t.length);this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}N.prototype.append=function(e,t){e=ue(e),t=_e(t);var r=this.map[e];this.map[e]=r?r+", "+t:t};N.prototype.delete=function(e){delete this.map[ue(e)]};N.prototype.get=function(e){return e=ue(e),this.has(e)?this.map[e]:null};N.prototype.has=function(e){return this.map.hasOwnProperty(ue(e))};N.prototype.set=function(e,t){this.map[ue(e)]=_e(t)};N.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)};N.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),Ce(e)};N.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),Ce(e)};N.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),Ce(e)};D.iterable&&(N.prototype[Symbol.iterator]=N.prototype.entries);function Te(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function ht(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function Yr(e){var t=new FileReader,r=ht(t);return t.readAsArrayBuffer(e),r}function Qr(e){var t=new FileReader,r=ht(t),n=/charset=([A-Za-z0-9_-]+)/.exec(e.type),s=n?n[1]:"utf-8";return t.readAsText(e,s),r}function en(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}function qe(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function mt(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:D.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:D.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:D.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():D.arrayBuffer&&D.blob&&Wr(e)?(this._bodyArrayBuffer=qe(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):D.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||Zr(e))?this._bodyArrayBuffer=qe(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):D.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},D.blob&&(this.blob=function(){var e=Te(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=Te(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(D.blob)return this.blob().then(Yr);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var e=Te(this);if(e)return e;if(this._bodyBlob)return Qr(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(en(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},D.formData&&(this.formData=function(){return this.text().then(nn)}),this.json=function(){return this.text().then(JSON.parse)},this}var tn=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function rn(e){var t=e.toUpperCase();return tn.indexOf(t)>-1?t:e}function se(e,t){if(!(this instanceof se))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t=t||{};var r=t.body;if(e instanceof se){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new N(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!r&&e._bodyInit!=null&&(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",(t.headers||!this.headers)&&(this.headers=new N(t.headers)),this.method=rn(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||(function(){if("AbortController"in P){var i=new AbortController;return i.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),(this.method==="GET"||this.method==="HEAD")&&(t.cache==="no-store"||t.cache==="no-cache")){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+new Date().getTime());else{var s=/\?/;this.url+=(s.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}se.prototype.clone=function(){return new se(this,{body:this._bodyInit})};function nn(e){var t=new FormData;return e.trim().split("&").forEach(function(r){if(r){var n=r.split("="),s=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(s),decodeURIComponent(i))}}),t}function sn(e){var t=new N,r=e.replace(/\r?\n[\t ]+/g," ");return r.split("\r").map(function(n){return n.indexOf(`
`)===0?n.substr(1,n.length):n}).forEach(function(n){var s=n.split(":"),i=s.shift().trim();if(i){var o=s.join(":").trim();try{t.append(i,o)}catch(a){console.warn("Response "+a.message)}}}),t}mt.call(se.prototype);function H(e,t){if(!(this instanceof H))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=t.status===void 0?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText===void 0?"":""+t.statusText,this.headers=new N(t.headers),this.url=t.url||"",this._initBody(e)}mt.call(H.prototype);H.prototype.clone=function(){return new H(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new N(this.headers),url:this.url})};H.error=function(){var e=new H(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var on=[301,302,303,307,308];H.redirect=function(e,t){if(on.indexOf(t)===-1)throw new RangeError("Invalid status code");return new H(null,{status:t,headers:{location:e}})};var ne=P.DOMException;try{new ne}catch{ne=function(t,r){this.message=t,this.name=r;var n=Error(t);this.stack=n.stack},ne.prototype=Object.create(Error.prototype),ne.prototype.constructor=ne}function gt(e,t){return new Promise(function(r,n){var s=new se(e,t);if(s.signal&&s.signal.aborted)return n(new ne("Aborted","AbortError"));var i=new XMLHttpRequest;function o(){i.abort()}i.onload=function(){var d={statusText:i.statusText,headers:sn(i.getAllResponseHeaders()||"")};s.url.indexOf("file://")===0&&(i.status<200||i.status>599)?d.status=200:d.status=i.status,d.url="responseURL"in i?i.responseURL:d.headers.get("X-Request-URL");var m="response"in i?i.response:i.responseText;setTimeout(function(){r(new H(m,d))},0)},i.onerror=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},i.ontimeout=function(){setTimeout(function(){n(new TypeError("Network request timed out"))},0)},i.onabort=function(){setTimeout(function(){n(new ne("Aborted","AbortError"))},0)};function a(d){try{return d===""&&P.location.href?P.location.href:d}catch{return d}}if(i.open(s.method,a(s.url),!0),s.credentials==="include"?i.withCredentials=!0:s.credentials==="omit"&&(i.withCredentials=!1),"responseType"in i&&(D.blob?i.responseType="blob":D.arrayBuffer&&(i.responseType="arraybuffer")),t&&typeof t.headers=="object"&&!(t.headers instanceof N||P.Headers&&t.headers instanceof P.Headers)){var c=[];Object.getOwnPropertyNames(t.headers).forEach(function(d){c.push(ue(d)),i.setRequestHeader(d,_e(t.headers[d]))}),s.headers.forEach(function(d,m){c.indexOf(m)===-1&&i.setRequestHeader(m,d)})}else s.headers.forEach(function(d,m){i.setRequestHeader(m,d)});s.signal&&(s.signal.addEventListener("abort",o),i.onreadystatechange=function(){i.readyState===4&&s.signal.removeEventListener("abort",o)}),i.send(typeof s._bodyInit>"u"?null:s._bodyInit)})}gt.polyfill=!0;P.fetch||(P.fetch=gt,P.Headers=N,P.Request=se,P.Response=H);var Ne,Ge;function an(){return Ge||(Ge=1,Ne=self.fetch.bind(self)),Ne}var cn=an();const ln=It(cn);function dn(){return{send:async e=>{const t=e.headers?Object.entries(e.headers).reduce((d,[m,u])=>({...d,[m.toLowerCase()]:(Array.isArray(u)?u.join(", "):u).toLowerCase()}),{}):{},r=t["content-type"]?.includes("application/json")??!1;let n;r&&e.data?n=JSON.stringify(e.data):n=e.data;const s={method:e.method,body:n,headers:t,follow:e.maxRedirects,signal:e.signal,timeout:e.timeout},i=await ln(e.url,s),o=i.headers.get("content-type")?.includes("application/json")??!1,a=await i.text();return{data:(o?JSON.parse(a):void 0)??a,body:a,ok:i.ok,status:i.status,statusText:i.statusText,headers:Object.fromEntries(i.headers.entries())}}}}const un=()=>({install(e){e.http=dn()}});class fn extends Re{name="ProgramNotRecognizedError";constructor(t,r){const n=!ye(t),s=t,i=r==="*"?"any":`the [${r}]`,o=`The provided program ${n?"name":"address"} [${s}] is not recognized in ${i} cluster. Did you forget to register this program? If so, you may use "context.programs.add(myProgram)" to fix this.`;super(o),this.identifier=t,this.cluster=r}}class hn extends Fr{name="ProgramErrorNotRecognizedError";constructor(t,r){const n=r.code?` of code [${r.code}]`:"",s=`The program [${t.name}] at address [${t.publicKey}] raised an error${n} that is not recognized by the programs registered on the SDK. Please check the underlying program error below for more details.`;super(s,t,r)}}function pt(e,t=[],r={}){const n=[...t],s={...r},i=(S,A="current")=>{const j=c(A),U=T(S);return ye(U)?j.some(k=>k.publicKey===U):j.some(k=>k.name===U)},o=(S,A="current")=>{const j=B(A),U=c(A),k=T(S),K=ye(k)?U.find(x=>x.publicKey===k):U.find(x=>x.name===k);if(!K)throw new fn(k,j);return K},a=(S,A,j)=>{try{return o(S,j).publicKey}catch(U){if(A===void 0)throw U;return le(A)}},c=(S="current")=>{const A=B(S);return A==="*"?n:n.filter(j=>j.isOnCluster(A))},d=(S,A=!0)=>{!A&&i(S.publicKey,"*")||n.unshift(S)},m=(S,A)=>{s[S]=A,T(S)},u=S=>{delete s[S]},h=()=>pt(e,n,s),I=(S,A)=>{if(!Array.isArray(S.logs)||S.logs.length===0)return null;const j=S.logs.join(`
`),U=/Error processing Instruction (\d+):/,k=S.message.match(U)?.[1]??null,K=/Custom program error: (0x[a-f0-9]+)/i,x=j.match(K)?.[1]??null,b=x?parseInt(x,16):null;if(k===null||b===null)return null;const p=parseInt(k,10),z=A.message.instructions?.[p]?.programIndex??null,v=z?A.message.accounts[z]:null;if(!v)return null;let L;try{L=o(v)}catch{return null}return L.getErrorFromCode(b,S)??new hn(L,S)},B=S=>S==="current"?e.rpc.getCluster():S,T=(S,A=[])=>{if(ye(S)||s[S]===void 0)return S;const j=[...A,S];if(A.includes(S))throw new Error(`Circular binding detected: ${j.join(" -> ")}`);return T(s[S],j)};return{has:i,get:o,getPublicKey:a,all:c,add:d,bind:m,unbind:u,clone:h,resolveError:I}}const mn=()=>({install(e){e.programs=pt(e)}});function We(e,t,r){let n=null;const s=()=>n||(typeof t=="string"?n=new At(t,r):n=t,n),i=vr(s().rpcEndpoint),o=async(x,b={})=>{const p=await s().getAccountInfo(O(x),b);return Xe(p,x)},a=async(x,b={})=>(await s().getMultipleAccountsInfo(x.map(O),b)).map((z,v)=>Xe(z,x[v])),c=async(x,b={})=>(await s().getProgramAccounts(O(x),{...b,filters:b.filters?.map(z=>gn(z))})).map(({pubkey:z,account:v})=>yt(v,q(z))),d=async(x,b={})=>{const p=await s().getBlockTime(x);return p?Ur(p):null},m=async(x,b={})=>{const p=await s().getBalance(O(x),b);return re(p)},u=async()=>await s().getGenesisHash(),h=async(x,b={})=>{const p=z=>s().getMinimumBalanceForRentExemption(z,b.commitment);if(b.includesHeaderBytes??!1){const z=await p(0),v=BigInt(z)/BigInt(xr);return re(v*BigInt(x))}return re(await p(x))},I=async(x={})=>s().getLatestBlockhash(x),B=async(x,b={})=>{const p=await s().getTransaction(R.deserialize(x)[0],{commitment:b.commitment,maxSupportedTransactionVersion:0});if(!p)return null;if(!p.meta)throw new Error("Transaction meta is missing.");const{transaction:z,meta:v}=p,L=ft(z.message),ee=g=>q(new ce(g)),W=g=>({accountIndex:g.accountIndex,amount:ut(g.uiTokenAmount.amount,"splToken",g.uiTokenAmount.decimals),mint:ee(g.mint),owner:g.owner?ee(g.owner):null});return{response:{blockTime:p.blockTime!=null?BigInt(p.blockTime):void 0,slot:BigInt(p.slot),version:p.version},message:L,serializedMessage:e.transactions.serializeMessage(L),signatures:z.signatures.map(R.serialize),meta:{fee:re(v.fee),logs:v.logMessages??[],preBalances:v.preBalances.map(re),postBalances:v.postBalances.map(re),preTokenBalances:(v.preTokenBalances??[]).map(W),postTokenBalances:(v.postTokenBalances??[]).map(W),innerInstructions:v.innerInstructions?.map(g=>({index:g.index,instructions:g.instructions.map(f=>({programIndex:f.programIdIndex,accountIndexes:f.accounts,data:R.serialize(f.data)}))}))??null,loadedAddresses:{writable:(v.loadedAddresses?.writable??[]).map(q),readonly:(v.loadedAddresses?.readonly??[]).map(q)},computeUnitsConsumed:v.computeUnitsConsumed?BigInt(v.computeUnitsConsumed):null,costUnits:v.costUnits?BigInt(v.costUnits):null,err:v.err}}},T=async(x,b={})=>(await s().getSignatureStatuses(x.map(z=>R.deserialize(z)[0]),{searchTransactionHistory:b?.searchTransactionHistory??!1})).value.map(z=>z?{slot:z.slot,confirmations:z.confirmations,error:z.err,commitment:z.confirmationStatus??null}:null),S=async(x,b={})=>!wr(await m(x,b)),A=async(x,b,p={})=>{const z=await s().requestAirdrop(O(x),Number(b.basisPoints));if(p.strategy){await K(R.serialize(z),p);return}await K(R.serialize(z),{...p,strategy:{type:"blockhash",...await I()}})},j=async(x,b,p={})=>{const z=s()._rpcClient,v=Array.isArray(b)?yn([...b],p.commitment,p.extra):xn(b,p.commitment,p.extra);return new Promise((L,ee)=>{const W=(g,f)=>{g?ee(g):L(f.result)};p.id?z.request(x,v,p.id,W):z.request(x,v,W)})},U=async(x,b={})=>{try{const p=await s().sendRawTransaction(e.transactions.serialize(x),b);return R.serialize(p)}catch(p){let z=null;throw p instanceof Error&&"logs"in p&&(z=e.programs.resolveError(p,x)),z||p}},k=async(x,b={})=>{try{const p=Jr(x);return(await s().simulateTransaction(p,{sigVerify:b.verifySignatures,accounts:{addresses:b.accounts||[],encoding:"base64"},replaceRecentBlockhash:b.replaceRecentBlockhash})).value}catch(p){let z=null;throw p instanceof Error&&"logs"in p&&(z=e.programs.resolveError(p,x)),z||p}},K=async(x,b)=>s().confirmTransaction(pn(x,b),b.commitment);return{getEndpoint:()=>s().rpcEndpoint,getCluster:()=>i,getAccount:o,getAccounts:a,getProgramAccounts:c,getBlockTime:d,getGenesisHash:u,getBalance:m,getRent:h,getSlot:async(x={})=>s().getSlot(x),getLatestBlockhash:I,getTransaction:B,getSignatureStatuses:T,accountExists:S,airdrop:A,call:j,sendTransaction:U,simulateTransaction:k,confirmTransaction:K,get connection(){return s()}}}function yt(e,t){return{executable:e.executable,owner:q(e.owner),lamports:re(e.lamports),rentEpoch:e.rentEpoch?BigInt(e.rentEpoch):void 0,publicKey:t,data:new Uint8Array(e.data)}}function Xe(e,t){return e?{...yt(e,t),exists:!0}:{exists:!1,publicKey:t}}function gn(e){if(!("memcmp"in e))return e;const{bytes:t,...r}=e.memcmp;return{memcmp:{...r,bytes:R.deserialize(t)[0]}}}function pn(e,t){return t.strategy.type==="blockhash"?{...t.strategy,signature:R.deserialize(e)[0]}:{...t.strategy,signature:R.deserialize(e)[0],nonceAccountPubkey:O(t.strategy.nonceAccountPubkey)}}function yn(e,t,r){if(!t&&!r)return e;let n={};return t&&(n.commitment=t),r&&(n={...n,...r}),e.push(n),e}function xn(e={},t,r){if(!t&&!r)return e;const n={...e};return t&&(n.commitment=t),r&&Object.assign(n,r),n}function Ze(e,t){return{install(r){r.rpc=typeof e=="string"?We(r,e,t):We(r,e)}}}const wn=(e,t=100)=>({...e,getAccounts:async(r,n)=>{const s=Pr(r,t).map(o=>e.getAccounts(o,n));return(await Promise.all(s)).flat()}}),bn=(e=100)=>({install(t){t.rpc=wn(t.rpc,e)}});function zn(e={}){return{tuple:gr,array:Y,map:dr,set:mr,option:fr,nullable:ur,struct:ae,enum:hr,dataEnum:lr,string:lt,bool:ar,unit:pr,u8:_,u16:tr,u32:ge,u64:rr,u128:nr,i8:Xt,i16:Zt,i32:Yt,i64:Qt,i128:er,f32:Gt,f64:Wt,bytes:xe,publicKey:Pe}}const Sn=(e={})=>({install(t){t.serializer=zn(e)}}),Ye=128,En=127;function vn(){const e=h=>{const I=Vr(h),B=ft(I),T=new rt(I,h.signatures);return{message:B,serializedMessage:n(B),signatures:T.signatures}},t=h=>i().serialize(h),r=h=>i().deserialize(h)[0],n=h=>o().serialize(h),s=h=>o().deserialize(h)[0],i=()=>({...Kt(ae([["signatures",Y(xe({size:64}),{size:Z()})],["serializedMessage",xe()]]),h=>h,h=>({...h,message:s(h.serializedMessage)})),description:"Transaction"}),o=()=>({description:"TransactionMessage",fixedSize:null,maxSize:null,serialize:h=>a(h.version).serialize(h),deserialize:(h,I=0)=>{const[B]=c().deserialize(h,I);return a(B).deserialize(h,I)}}),a=h=>ae([["version",c()],["header",d()],["accounts",Y(Pe(),{size:Z()})],["blockhash",lt({encoding:R,size:32})],["instructions",Y(m(),{size:Z()})],["addressLookupTables",Y(u(),{size:h==="legacy"?0:Z()})]]),c=()=>({description:"TransactionVersion",fixedSize:null,maxSize:1,serialize:h=>h==="legacy"?new Uint8Array([]):new Uint8Array([Ye|h]),deserialize:(h,I=0)=>{const B=h.slice(I);if(B.length===0||(B[0]&Ye)===0)return["legacy",I];const T=B[0]&En;if(T>0)throw new Re(`Unsupported transaction version: ${T}.`);return[T,I+1]}}),d=()=>ae([["numRequiredSignatures",_()],["numReadonlySignedAccounts",_()],["numReadonlyUnsignedAccounts",_()]]),m=()=>ae([["programIndex",_()],["accountIndexes",Y(_(),{size:Z()})],["data",xe({size:Z()})]]),u=()=>ae([["publicKey",Pe()],["writableIndexes",Y(_(),{size:Z()})],["readonlyIndexes",Y(_(),{size:Z()})]]);return{create:e,serialize:t,deserialize:r,serializeMessage:n,deserializeMessage:s}}const In=()=>({install(e){e.transactions=vn()}});function Qe(e,t){return{install(r){r.use(Sn()),r.use(mn()),r.use(un()),r.use(Lr()),r.use(Gr()),r.use(typeof e=="string"?Ze(e,t):Ze(e)),r.use(bn(t?.getAccountsChunkSize)),r.use(In())}}}function An(e,t){return Mr().use(Qe(e,t))}async function Tn(e,t){try{const r=An(e.rpcEndpoint),n=le(t.toString()),s=await Nt.fetchMetadata(r,n);let i=null;s.creators&&(i=s.creators.value.map(c=>({address:new ce(c.address),verified:c.verified,share:c.share})));let o=null;if(s.collection){const a=s.collection.value;o={verified:a.verified,key:new ce(a.key)}}return{mint:t,data:{name:s.name,symbol:s.symbol,uri:s.uri,sellerFeeBasisPoints:s.sellerFeeBasisPoints,creators:i},primarySaleHappened:s.primarySaleHappened,isMutable:s.isMutable,collection:o}}catch{return null}}function Dn(){const{connection:e}=bt(),t=zt(),r=Bt(t,e),[n,s]=V.useState(!0),[i,o]=V.useState(!1),[a,c]=V.useState(null),[d,m]=V.useState([]),[u,h]=V.useState(new Set),[I,B]=V.useState(new Set),[T,S]=V.useState(new Set),[A,j]=V.useState(new Map);V.useEffect(()=>{(async()=>{if(!r||!t.publicKey){$({title:"Error",description:"Wallet not connected",color:"danger"});return}if(!i)try{s(!0),c(null);const f=await r.getPaymentPoliciesByUser(t.publicKey),E=new Map,y=new Map;for(const w of f){const X=w.account.userPayment.toString();if(!E.has(X)){const F=await r.getUserPayment(w.account.userPayment);if(F){E.set(X,{userPaymentAddress:w.account.userPayment,userPayment:F,policies:[]});const ze=F.tokenMint.toString();if(!y.has(ze))try{const fe=await Tt(e,F.tokenMint),Me=await Tn(e,F.tokenMint);y.set(ze,{decimals:fe.decimals,metadata:Me??void 0,symbol:Me?.data.symbol})}catch(fe){console.error("Error fetching mint info:",fe)}}}const te=E.get(X);te&&te.policies.push(w)}y.set("4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU",{decimals:6,symbol:"USDC"}),m(Array.from(E.values())),j(y),o(!0)}catch(f){const E=f instanceof Error?f.message:"Failed to fetch payment policies";c(E),console.error("Error fetching payment policies:",f)}finally{s(!1)}})()},[r,i,e,t.publicKey]);const U=g=>{const f=g.policyType;return f.subscription?"Subscription":f.oneTime?"One Time":f.installment?"Installment":"Unknown"},k=g=>{const f=g.policyType;let E=0;if(f.subscription?E=Number(f.subscription.intervalSeconds):f.installment&&(E=Number(f.installment.intervalSeconds)),E===0)return"N/A";const y=Dt({start:0,end:E*1e3});return Ut(y,{format:["years","months","weeks","days","hours","minutes","seconds"]})},K=g=>{const f=g.policyType.subscription.nextPaymentDue;if(!f)return"N/A";const E=new Date(f.toNumber()*1e3);return E<new Date?"Overdue":$t(E,{addSuffix:!0})},x=g=>{if(!g.memo||g.memo.length===0)return"";try{const f=new TextDecoder,E=g.memo.filter(y=>y!==0);return f.decode(new Uint8Array(E))}catch{return""}},b=g=>{const f=g.status;return f.active?"Active":f.paused?"Paused":f.cancelled?"Cancelled":f.completed?"Completed":f.failed?"Failed":"Unknown"},p=g=>{const f=g.policyType;let E=null;return f.subscription&&(E=Number(f.subscription.amount)),E===null?null:E.toString()},z=(g,f)=>{if(!g)return"N/A";console.log(g);const E=A.get(f.toString());if(!E)return g;const w=(Number(g)/Math.pow(10,E.decimals)).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:E.decimals});return E.symbol?`${w} ${E.symbol}`:w},v=g=>{const f=g.policyType.subscription.nextPaymentDue;return f?new Date(f.toNumber()*1e3)<=new Date:!1},L=async(g,f,E)=>{if(!r||!t.publicKey){$({title:"Error",description:"Wallet not connected",color:"danger"});return}try{const y=await r.getPaymentGateway(f.gateway);if(!y){$({title:"Error",description:"Gateway not found",color:"danger"});return}if(y.authority.toString()!==t.publicKey.toString()&&E.owner.toString()!=t.publicKey.toString()){$({title:"Error",description:"Only the gateway authority can execute payments",color:"danger"});return}h(F=>new Set(F).add(g.toString()));const w=new ve;(await r.executePayment(g)).map(F=>w.add(F));const te=await r.provider.sendAndConfirm(w);$({title:"Success",description:`Payment executed successfully! TX: ${te}`,color:"success"}),o(!1)}catch(y){console.error("Error executing payment:",y),$({title:"Error",description:y instanceof Error?y.message:"Failed to execute payment",color:"danger"})}finally{h(y=>{const w=new Set(y);return w.delete(g.toString()),w})}},ee=async(g,f,E)=>{if(!r||!t.publicKey){$({title:"Error",description:"Wallet not connected",color:"danger"});return}if(E.owner.toString()!==t.publicKey.toString()){$({title:"Error",description:"Only the policy owner can change status",color:"danger"});return}try{B(fe=>new Set(fe).add(g.toString()));const w=f.status.active,X=w?{paused:{}}:{active:{}},te=new ve,F=await r.changePaymentPolicyStatus(E.tokenMint,f.policyId,X);te.add(F),await r.provider.sendAndConfirm(te),$({title:"Success",description:`Payment policy ${w?"paused":"resumed"} successfully!`,color:"success"}),o(!1)}catch(y){console.error("Error toggling payment policy status:",y),$({title:"Error",description:y instanceof Error?y.message:"Failed to toggle policy status",color:"danger"})}finally{B(y=>{const w=new Set(y);return w.delete(g.toString()),w})}},W=async(g,f,E)=>{if(!r||!t.publicKey){$({title:"Error",description:"Wallet not connected",color:"danger"});return}if(E.owner.toString()!==t.publicKey.toString()){$({title:"Error",description:"Only the policy owner can delete the policy",color:"danger"});return}if(confirm("Are you sure you want to delete this payment policy? This action cannot be undone."))try{S(X=>new Set(X).add(g.toString()));const y=new ve,w=await r.deletePaymentPolicy(E.tokenMint,f.policyId);y.add(w),await r.provider.sendAndConfirm(y),$({title:"Success",description:"Payment policy deleted successfully!",color:"success"}),o(!1)}catch(y){console.error("Error deleting payment policy:",y),$({title:"Error",description:y instanceof Error?y.message:"Failed to delete policy",color:"danger"})}finally{S(y=>{const w=new Set(y);return w.delete(g.toString()),w})}};return l.jsx("div",{className:"container mx-auto px-4 py-8",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[n&&l.jsxs("div",{className:"flex justify-center items-center min-h-[400px]",children:[l.jsx(xt,{size:"lg"}),l.jsx("span",{className:"ml-4 text-gray-600",children:"Loading payment policies..."})]}),!n&&a&&l.jsx(wt,{color:"danger",description:a}),!n&&!a&&d.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx("p",{className:"text-gray-600 text-lg",children:"No payment policies found"}),l.jsx("p",{className:"text-gray-500 mt-2",children:"Create your first payment policy to get started"})]}),!n&&!a&&d.length>0&&l.jsxs("div",{className:"w-full space-y-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"User Payments & Policies"}),l.jsx("p",{className:"text-gray-600",children:"View all user payment accounts and their associated policies"})]}),d.map(({userPaymentAddress:g,userPayment:f,policies:E})=>l.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-4",children:[l.jsx("h3",{className:"text-lg font-semibold mb-3",children:"User Payment Account"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Address"}),l.jsx("div",{className:"font-mono text-sm mt-1",children:l.jsx(he,{publicKey:g})})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Owner"}),l.jsx("div",{className:"font-mono text-sm mt-1",children:l.jsx(he,{publicKey:f.owner})})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Token Mint"}),l.jsx("div",{className:"font-mono text-sm mt-1",children:l.jsx(he,{publicKey:f.tokenMint})})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Active Policies"}),l.jsx("div",{className:"text-lg font-semibold mt-1",children:f.activePoliciesCount})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),l.jsx("div",{className:"text-sm font-semibold mt-1",children:f.isActive?l.jsx("span",{className:"text-green-600",children:"Active"}):l.jsx("span",{className:"text-red-600",children:"Inactive"})})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Created At"}),l.jsx("div",{className:"text-sm mt-1",children:new Date(f.createdAt.toNumber()*1e3).toLocaleString()})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Updated At"}),l.jsx("div",{className:"text-sm mt-1",children:new Date(f.updatedAt.toNumber()*1e3).toLocaleString()})]})]})]}),l.jsxs("div",{className:"p-4",children:[l.jsxs("h4",{className:"text-md font-semibold mb-3",children:["Payment Policies (",E.length,")"]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-900",children:[l.jsx("th",{className:"border p-2 text-left text-xs",children:"Policy Address"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"ID"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Type"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Amount"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Recipient"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Total Paid"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Interval"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Next Payment"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Status"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Payments"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Memo"}),l.jsx("th",{className:"border p-2 text-left text-xs",children:"Actions"})]})}),l.jsx("tbody",{children:E.map(({publicKey:y,account:w})=>l.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-900",children:[l.jsx("td",{className:"border p-2 font-mono text-xs",children:l.jsx(he,{publicKey:y})}),l.jsx("td",{className:"border p-2 text-center text-sm",children:w.policyId}),l.jsx("td",{className:"border p-2 text-sm",children:U(w)}),l.jsx("td",{className:"border p-2 text-sm",children:z(p(w),f.tokenMint)}),l.jsx("td",{className:"border p-2 font-mono text-xs",children:l.jsx(he,{publicKey:w.recipient})}),l.jsx("td",{className:"border p-2 font-mono text-xs",children:z(w.totalPaid.toString(),f.tokenMint)}),l.jsx("td",{className:"border p-2 text-sm",children:k(w)}),l.jsx("td",{className:"border p-2 text-sm",children:K(w)}),l.jsx("td",{className:"border p-2",children:l.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:b(w)})}),l.jsx("td",{className:"border p-2 text-center text-sm",children:w.paymentCount}),l.jsx("td",{className:"border p-2 text-xs",children:x(w)}),l.jsx("td",{className:"border p-2",children:l.jsxs("div",{className:"flex gap-1",children:[l.jsx(Se,{size:"sm",isIconOnly:!0,color:"primary",variant:"flat",isDisabled:!v(w)||u.has(y.toString()),isLoading:u.has(y.toString()),onPress:()=>L(y,w,f),children:l.jsx(jt,{className:"h-4 w-4"})}),l.jsx(Se,{size:"sm",isIconOnly:!0,color:b(w)==="Active"?"warning":"success",variant:"flat",isDisabled:I.has(y.toString()),isLoading:I.has(y.toString()),onPress:()=>ee(y,w,f),children:b(w)==="Active"?l.jsx(Pt,{className:"h-4 w-4"}):l.jsx(Ot,{className:"h-4 w-4"})}),l.jsx(Se,{size:"sm",isIconOnly:!0,color:"danger",variant:"flat",isDisabled:T.has(y.toString()),isLoading:T.has(y.toString()),onPress:()=>W(y,w,f),children:l.jsx(kt,{className:"h-4 w-4"})})]})})]},y.toString()))})]})})]})]},g.toString())),l.jsxs("div",{className:"text-gray-600 text-sm",children:["Total user payments: ",l.jsx("span",{className:"font-semibold",children:d.length})," | ","Total policies:"," ",l.jsx("span",{className:"font-semibold",children:d.reduce((g,f)=>g+f.policies.length,0)})]})]})]})})}export{Dn as default};
